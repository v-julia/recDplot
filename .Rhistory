color_pairs(gamma, 'JF705860', 1,19470,19471,23229)
pdf.options(encoding = 'CP1250')
fig_path = "C:/Users/alxva/Google Диск/Coronaviruses/paper/figures2/"
fig_path = "D:/DATA/Virology/Coronaviruses/paper/figures2/"
color_pairs = function(dna_obj, stri, s1, e1, s2, e2){
l = plot_dist_test(dna_obj, s1, e1, s2, e2)
d_matrix= as.matrix(l[[2]])
d_matrix2= as.matrix(l[[3]])
ind_str=c()
ind_other=c()
for (i in (1:nrow(d_matrix))){
name = rownames(d_matrix)[i]
if (grepl(stri, name, fixed=TRUE)){
print(i)
ind_str = c(ind_str,i)
}
else {
ind_other = c(ind_other, i)
}
}
str_distances1 = as.vector(d_matrix[ind_str,])
other_distances1 = as.vector(d_matrix[ind_other,])
str_distances2 = as.vector(d_matrix2[ind_str,])
other_distances2 = as.vector(d_matrix2[ind_other,])
v = rep(c(stri), times = length(str_distances2))
nv = rep(c('other'), times = length(other_distances2))
df1 = data.frame(str_distances1,str_distances2,v)
df2 = data.frame(other_distances1,other_distances2,nv)
colnames(df1) = c('d1','d2', 'q')
colnames(df2) = c('d1','d2', 'q')
df= rbind(df2,df1)
ggplot(data.frame(df),aes(df$d1,df$d2), label=df$q) + geom_point(aes(color=q)) +
theme(legend.justification=c(1,0), legend.position=c(1,0))+
xlab("dist1")+ylab("dist2")
#plot(str_distances1,str_distances2, col = 'red')
}
gamma_name = 'D:/DATA/Virology/Coronaviruses/gb/gamma_again/Gammacoronavirus_less_amb_1ABSEMN_aln_1.0_0.9ng_del.fasta'
gamma = read.dna(gamma_name, format="fasta", as.character=TRUE)
library("recDplot")
library(ggplot2)
library(reticulate)
library("ape")
library("seqinr")
library(sjstats)
library("spider")
library("gridExtra")
#library(hexbin)
library(grid)
library(gplots)
library(colorRamps)
gamma_name = 'D:/DATA/Virology/Coronaviruses/gb/gamma_again/Gammacoronavirus_less_amb_1ABSEMN_aln_1.0_0.9ng_del.fasta'
gamma = read.dna(gamma_name, format="fasta", as.character=TRUE)
gamma[gamma=='-'] <- NA
l = plot_dist_test(gamma, 1,11781,11782,19470)
l[[1]]
ggsave(file=paste(fig_path, "Gamma_new_1Avs1B.svg", sep=""), plot=l[[1]], width=10, height=8)
color_pairs(gamma, 'LN610099', 1, 11781, 11782, 19470)
color_pairs(gamma, 'JF705860', 1, 11781, 11782, 19470)
color_pairs(gamma, 'EU095850', 1, 11781, 11782, 19470)
gamma_name = 'D:/DATA/Virology/Coronaviruses/gb/gamma_again/Gammacoronavirus_less_amb_1ABSEMN_aln_0.002.0_0.9ng.fasta'
gamma = read.dna(gamma_name, format="fasta", as.character=TRUE)
gamma[gamma=='-'] <- NA
color_pairs(gamma, 'LN610099', 1, 10000, 10001, 19720)
color_pairs(gamma, 'JF705860', 1, 10000, 10001, 19720)
color_pairs(gamma, 'EU095850', 1, 10000, 10001, 19720)
gamma_name = 'D:/DATA/Virology/Coronaviruses/gb/gamma_again/Gammacoronavirus_less_amb_1ABSEMN_aln_1.0_0.9ng_del.fasta'
gamma = read.dna(gamma_name, format="fasta", as.character=TRUE)
gamma[gamma=='-'] <- NA
l = plot_dist_test(gamma, 1,19470,19471,23229)
l[[1]]
ggsave(file=paste(fig_path, "gamma_new_1ABvsS.svg", sep=""), plot=l[[1]], width=10, height=8)
color_pairs(gamma, 'JF705860', 1,19470,19471,23229)
color_pairs(gamma, 'LN610099', 1, 19470,19471,23229)
color_pairs(gamma, 'EU095850', 1, 19470,19471,23229)
l = plot_dist_test(gamma, 19738,21348,21349,23229)
l[[1]]
ggsave(file=paste(fig_path, "Gamma_new_S1vsS2.svg", sep=""), plot=l[[1]], width=10, height=8)
color_pairs(gamma, 'JF705860', 19738,21348,21349,23229)
color_pairs(gamma, 'LN610099', 19738,21348,21349,23229)
color_pairs(gamma, 'EU095850', 19738,21348,21349,23229)
l = plot_dist_test(gamma, 19795,20448,20545,20952)
l[[1]]
ggsave(file=paste(fig_path, "Gamma_new_NTDvsRBD.svg", sep=""), plot=l[[1]], width=10, height=8)
color_pairs(gamma, 'JF705860', 19795,20448,20545,20952)
color_pairs(gamma, 'LN610099', 19795,20448,20545,20952)
l = plot_dist_test(gamma, 19795,20100,20101,20448)
l[[1]]
ggsave(file=paste(fig_path, "Gamma_new_NTDvsNTD.svg", sep=""), plot=l[[1]], width=10, height=8)
color_pairs(gamma, 'JF705860',  19795,20100,20101,20448)
color_pairs(gamma, 'EU095850', 19795,20448,20545,20952)
color_pairs(gamma, 'LN610099', 19795,20100,20101,20448)
color_pairs(gamma, 'EU095850', 19795,20100,20101,20448)
l = plot_dist_test(gamma, 20545,20750,20751,20952)
l[[1]]
ggsave(file=paste(fig_path, "Gamma_new_RBDvsRBD.svg", sep=""), plot=l[[1]], width=10, height=8)
color_pairs(gamma, 'JF705860',20545,20750,20751,20952)
color_pairs(gamma, 'LN610099', 20545,20750,20751,20952)
color_pairs(gamma, 'EU095850', 20545,20750,20751,20952)
l = plot_dist_test(gamma, 19795,20448,21349,23229)
l[[1]]
ggsave(file=paste(fig_path, "Gamma_new_NTDvsS2.svg", sep=""), plot=l[[1]], width=10, height=8)
color_pairs(gamma, 'JF705860', 19795,20448,21349,23229)
color_pairs(gamma, 'LN610099',19795,20448,21349,23229)
color_pairs(gamma, 'EU095850', 19795,20448,21349,23229)
l = plot_dist_test(gamma, 20545,20952,21349,23229)
l[[1]]
ggsave(file=paste(fig_path, "Gamma_new_RBDvsS2.svg", sep=""), plot=l[[1]], width=10, height=8)
color_pairs(gamma, 'JF705860', 20545,20952,21349,23229)
color_pairs(gamma, 'LN610099', 20545,20952,21349,23229)
color_pairs(gamma, 'EU095850', 20545,20952,21349,23229)
l = plot_dist_test(gamma, 1,19470,19471,23229)
l[[1]]
ggsave(file=paste(fig_path, "gamma_new_1ABvsS.svg", sep=""), plot=l[[1]], width=10, height=8)
color_pairs(gamma, 'JF705860',1,19470,19471,23229)
color_pairs(gamma, 'LN610099',1,19470,19471,23229)
color_pairs(gamma, 'EU095850',1,19470,19471,23229)
color_pairs(gamma, 'JF705860', 1,19470,23230,25428)
color_pairs(gamma, 'LN610099', 1, 19470,23230,25428)
color_pairs(gamma, 'EU095850', 1, 19470,23230,25428)
setwd("D:\DATA\Virology\Coronaviruses\gb\RF_matrices")
setwd("D:/DATA/Virology/Coronaviruses/gb/RF_matrices/")
library("recDplot")
library(ggplot2)
library(reticulate)
library("ape")
library("seqinr")
library(sjstats)
library("spider")
library("gridExtra")
#library(hexbin)
library(grid)
library(gplots)
library(colorRamps)
pdf.options(encoding = 'CP1250')
fig_path = "C:/Users/alxva/Google Диск/Coronaviruses/paper/figures2/"
fig_path = "D:/DATA/Virology/Coronaviruses/paper/figures2/"
path_al = "D:/DATA/Virology/Coronaviruses/gb/"
#path_al = "C:/Users/alxva/Google Диск/Coronaviruses/gb/"
alpha_name = 'Alphacoronavirus_less_amb_1ABSEMN_aln_1.0_0.9ng — копия.fasta'
alpha = read.dna(paste(path_al, 'alpha/', alpha_name, sep=""), format="fasta", as.character=TRUE)
alpha[alpha=='-'] <- NA
alpha_rmse = plot_rmse(alpha, 100, 800,"pdist","pairwise")
rf_alpha = read.csv("Alpha_RFdist_matrix.csv")
rf_beta = read.csv("Beta_RF_matrix.csv")
rf_gamma = read.csv("Gamma_RF_matrix.csv")
rf_delta = read.csv("D-CoV_RF.csv")
rf_alpha = read.csv("D:/DATA/Virology/Coronaviruses/gb/RF_matrices/Alpha_RFdist_matrix.csv")
rf_beta = read.csv("D:/DATA/Virology/Coronaviruses/gb/RF_matrices/Beta_RF_matrix.csv")
rf_gamma = read.csv("D:/DATA/Virology/Coronaviruses/gb/RF_matrices/Gamma_RF_matrix.csv")
rf_delta = read.csv("D:/DATA/Virology/Coronaviruses/gb/RF_matrices/D-CoV_RF.csv")
alpha_rmse
write.table(alpha_rmse,file="alpha_rmse.txt") # keeps the rownames
write.table(alpha_rmse,file=paste(path_al, 'alpha/alpha_rmse.txt')) # keeps the rownames
paste(path_al, 'alpha/alpha_rmse.txt'))
paste(path_al, 'alpha/alpha_rmse.txt')
write.table(alpha_rmse,file=paste(path_al, 'alpha/alpha_rmse.txt', sep="")) # keeps the rownames
folder_new = 'D:/DATA/Virology/Coronaviruses/gb/new_datasets/'
beta_name = 'Beta_1ABSEMN_1.0_0.9ng — копия.fasta'
beta = read.dna(paste(folder_new, 'beta/', beta_name, sep=""), format="fasta", as.character=TRUE)
beta[beta=='-'] <- NA
beta_rmse = plot_rmse(beta, 100, 800,"pdist","pairwise")
write.table(beta_rmse,file=paste(path_al, 'beta_rmse.txt', sep="")) # keeps the rownames
gamma_name = 'Gammacoronavirus_less_amb_1ABSEMN_aln_0.7ng_0.5.fasta'
gamma_name = 'Gammacoronavirus_less_amb_1ABSEMN_aln_1.0_0.9ng — копия.fasta'
gamma = read.dna(paste(path_al, 'gamma/', gamma_name, sep=""), format="fasta", as.character=TRUE)
gamma[gamma=='-'] <- NA
gamma_rmse = plot_rmse(gamma, 100, 800,"pdist","pairwise")
write.table(gamma_rmse,file=paste(path_al, 'gamma/gamma_rmse', sep="")) # keeps the rownames
folder_new = 'D:/DATA/Virology/Coronaviruses/gb/new_datasets/'
delta_name = 'D-CoV_1ABSEMN_0.5_0.9ng.fasta'
delta = read.dna(paste(folder_new, 'delta/', delta_name, sep=""), format="fasta", as.character=TRUE)
delta[delta=='-'] <- NA
delta_rmse = plot_rmse(delta, 100, 800,"pdist","pairwise")
delta_rmse = plot_rmse(delta, 100, 800,"pdist","pairwise")
write.table(delta_rmse,file=paste(path_al, 'delta/delta_rmse', sep="")) # keeps the rownames
write.table(delta_rmse,file=paste(folder_new, 'delta/delta_rmse.txt', sep="")) # keeps the rownames
rmse_alpha = read.csv("D:/DATA/Virology/Coronaviruses/gb/RF_matrices/alpha_rmse.txt")
rmse_beta = read.csv("D:/DATA/Virology/Coronaviruses/gb/RF_matrices/beta_rmse.txt")
rmse_gamma = read.csv("D:/DATA/Virology/Coronaviruses/gb/RF_matrices/gamma_rmse.txt")
rmse_delta = read.csv("D:/DATA/Virology/Coronaviruses/gb/RF_matrices/delta_rmse.txt")
rmse_alpha
rmse_alpha = read.csv("D:/DATA/Virology/Coronaviruses/gb/RF_matrices/alpha_rmse.txt", sep=' ')
rmse_beta = read.csv("D:/DATA/Virology/Coronaviruses/gb/RF_matrices/beta_rmse.txt", sep=' ')
rmse_gamma = read.csv("D:/DATA/Virology/Coronaviruses/gb/RF_matrices/gamma_rmse.txt", sep=' ')
rmse_delta = read.csv("D:/DATA/Virology/Coronaviruses/gb/RF_matrices/delta_rmse.txt", sep=' ')
View(rmse_alpha)
rmse_alpha[1]
diag(rmse_alpha)
alpha_diag = lower.tri(rmse_alpha, diag = FALSE)
View(alpha_diag)
alpha_diag = rmse_alpha[lower.tri(rmse_alpha, diag = FALSE)]
alpha_diag_log = lower.tri(rmse_alpha, diag = FALSE)
View(alpha_diag_log)
rmse_alpha[alpha_diag_log]
(m2 <- matrix(1:20, 4, 5))
m2[lower.tri(m2)] <- NA
m2
rmse_alpha[1:5]
rmse_alpha[1:5][alpha_diag_log]
a = rmse_alpha[1:5][alpha_diag_log]
a = rmse_alpha[1:5][alpha_diag_log[1:5]]
View(a)
[alpha_diag_log[1:5]
alpha_diag_log[1:5]
alpha_diag_log[1:5,]
a = rmse_alpha[1:5][alpha_diag_log[1:5,]]
a = rmse_alpha[1:5]
a[alpha_diag_log[1:5,] = NA
a[alpha_diag_log[1:5] = NA
a[alpha_diag_log[1:5,]] = NA
a[alpha_diag_log[1:5]] = NA
View(a)
alpha_diag_log[1:5]
alpha_diag_log[,1:5]
a = rmse_alpha[1:5]
a[alpha_diag_log[,1:5]]
a[alpha_diag_log[,1:5]]=NA
alpha_diag_log = upper.tri(rmse_alpha, diag = FALSE)
a[alpha_diag_log[1:5]]
a = rmse_alpha[1:5]
a[alpha_diag_log[1:5]]=NA
a[alpha_diag_log[,1:5]]=NA
alpha_diag_log[,1:5]]
alpha_diag_log[,1:5]
a[alpha_diag_log[,1:5]]=NA
a.sum()
sum(a)
sum(a!-NA)
sum(a!=NA)
sum(a[a!=NA])
a
a[a!=NA]
sum(a, na.rm=T)
as.vector(a)
as.vector(a)[1]
as.vector(a)[2]
a = rmse_alpha[1:190]
a = as.vector(a)
ncol(a)
ncol(alpha_rmse)
a_s = rmse_alpha[191:224]
a_s[alpha_diag_log[,191:224]]=NA
View(a_s)
t.test(a_1ab,a_s)
#orf1ab
a_1ab = rmse_alpha[1:190]
a_1ab[alpha_diag_log[,1:190]]=NA
t.test(a_1ab,a_s)
a_1ab = rf_alpha[1:190]
alpha_diag_log = upper.tri(rf_alpha, diag = FALSE)
a_1ab[alpha_diag_log[,1:190]]=NA
a = as.vector(a)
a_s = rf_alpha[191:224]
a_s[alpha_diag_log[,191:224]]=NA
t.test(a_1ab,a_s)
a_s = rf_alpha[225:238]
a_s[alpha_diag_log[,225:238]]=NA
t.test(a_1ab,a_s)
alpha_diag_log = upper.tri(rmse_alpha, diag = FALSE)
#orf1ab
a_1ab = rmse_alpha[1:190]
a_1ab[alpha_diag_log[,1:190]]=NA
a = as.vector(a)
a_s = rmse_alpha[191:224]
a_s = rmse_alpha[225:238]
a_s[alpha_diag_log[,225:238]]=NA
t.test(a_1ab,a_s)
a_s = rmse_alpha[191:224]
a_s[alpha_diag_log[,191:224]]=NA
t.test(a_1ab,a_s)
hist(a_s)
hist(c(a_s))
a_s
c(a_s)
array(a_s)
a_s_ar = array(a_s)
a_s_ar = a_s_ar[!is.na(a_s_ar)]
hist(a_s_ar)
a_1ab_ar = array(a_1ab)
a_1abs_ar = a_1ab_ar[!is.na(a_1ab_ar)]
hist(a_1abs_ar)
wilcox.test(a_1abs_ar, a_s_ar, alternative = "two.sided")
setwd("D:/DATA/Virology/Coronaviruses/gb/RF_matrices/")
rf_alpha = read.csv("D:/DATA/Virology/Coronaviruses/gb/RF_matrices/Alpha_RFdist_matrix.csv")
rf_beta = read.csv("D:/DATA/Virology/Coronaviruses/gb/RF_matrices/Beta_RF_matrix.csv")
rf_gamma = read.csv("D:/DATA/Virology/Coronaviruses/gb/RF_matrices/Gamma_RF_matrix.csv")
rf_delta = read.csv("D:/DATA/Virology/Coronaviruses/gb/RF_matrices/D-CoV_RF.csv")
a_1ab = rf_alpha[1:190]
alpha_diag_log = upper.tri(rf_alpha, diag = FALSE)
a_1ab[alpha_diag_log[,1:190]]=NA
a = as.vector(a)
a_s = rf_alpha[191:224]
a_s[alpha_diag_log[,191:224]]=NA
wilcox.test(a_1ab, a_s, alternative = "two.sided")
a_s
a_1abs_ar = a_1ab_ar[!is.na(a_1ab)]
a_s_ar = a_s[!is.na(a_s)]
wilcox.test(a_1ab, a_s, alternative = "two.sided")
a_1abs_ar = as.array(a_1ab_ar[!is.na(a_1ab)])
a_s_ar = as.array(a_s[!is.na(a_s)])
wilcox.test(a_1ab, a_s, alternative = "two.sided")
a_s_ar
wilcox.test(a_1abs_ar, a_s_ar, alternative = "two.sided")
dir = 'D:/DATA/Virology/Coronaviruses/gb/gamma_again/'
file = read.csv(paste(dir,'Default. RNAFold_Sum.DAT',sep=''), header=TRUE, sep='\t')
View(file)
library(ggplot)
library(ggplot2)
ggplot(file, aes(x=file$Start, y=file$MFED, label=Sequence))
ggplot(file, aes(x=file$Start, y=file$MFED, label=Sequence))+ geom_line()
ggplot(file, aes(x=file$Start, y=file$MFED, label=Sequence))+ geom_line(color=file$Sequence)
ggplot(file, aes(x=file$Start, y=file$MFED, label=Sequence))+ geom_line(aes(color=file$Sequence))
ggplot(file, aes(x=file$Start, y=file$MFED, label=Sequence))+ geom_line(aes(color=file$Group))
ggplot(file, aes(x=Start, y=MFED))+ geom_line(aes(color=file$Group))
ggplot(file, aes(x=Start, y=MFED))+ geom_line(aes(color=Group))
df = read.csv(paste(dir,'Default. RNAFold_Sum.DAT',sep=''), header=TRUE, sep='\t')
View(file)
View(file)
View(file)
df[df$Group=='Igacovirus-chick']
df$Group=='Igacovirus-chick'
df[:,df$Group=='Igacovirus-chick']
df[1]
df[df$Group=='Igacovirus-chick',]
df_avian = df[df$Group=='Igacovirus-chick',]
ggplot(df_avian, aes(x=Start, y=MFED))+ geom_line(aes(color=Sequence))
dir = 'D:/DATA/Virology/Coronaviruses/gb/new_datasets/delta/'
df = read.csv(paste(dir,'Default. RNAFold_Sum.DAT',sep=''), header=TRUE, sep='\t')
ggplot(df, aes(x=Start, y=MFED))+ geom_line(aes(color=Group))
ggplot(df[df$Group!='unclf',], aes(x=Start, y=MFED))+ geom_line(aes(color=Group))
View(df)
ggplot(df[df$Group=='Buldecovirus_PCoV',], aes(x=Start, y=MFED))+ geom_line(aes(color=Group))
ggplot(df[df$Group=='Buldecovirus_PCoV',], aes(x=Start, y=MFED))+ geom_line(aes(color=Sequence)
ggplot(df[df$Group=='Buldecovirus_PCoV',], aes(x=Start, y=MFED))+ geom_line(aes(color=Sequence))
ggplot(df[df$Group=='Buldecovirus_PCoV',], aes(x=Start, y=MFED))+ geom_line(aes(color=Sequence))
ggplot(df[df$Group=='Buldecovirus_PCoV',], aes(x=Start, y=MFED))+ geom_line(aes(color=Group))
dir = 'D:/DATA/Virology/Coronaviruses/gb/gamma_again/'
sim =  read.csv(paste(dir,'gamma_ibv_simplot.csv',sep=''), header=TRUE, sep='\t')
View(sim)
sim =  read.csv(paste(dir,'gamma_ibv_simplot.csv',sep=''), header=TRUE, sep=',')
View(sim)
sim =  read.csv(paste(dir,'gamma_ibv_simplot.csv',sep=''), header=TRUE, sep=',')
sim =  read.csv(paste(dir,'gamma_ibv_simplot.csv',sep=''), header=TRUE, sep=',')
sim =  read.csv(paste(dir,'gamma_ibv_simplot.csv',sep=''), header=TRUE, sep=',')
ggplot(sim, aes(x=Position.in.alignment, y=sim$KU556804_chicken_AUS_2012_Igacovir...KY407556_chicken_CHN))+ geom_line()
ggplot(sim, aes(x=Position.in.alignment, y=sim$KU556804_chicken_AUS_2012_Igacovir...KY407556_chicken_CHN))+ geom_line(aes(x=Position.in.alignment,y=sim$KU556804_chicken_AUS_2012_Igacovir...KY407556_chicken_CHN, color=red)) + geom_line(aes(x=Position.in.alignment,y=sim$KU556804_AUS_2012_Igacovir...KY407557, color=red))
ggplot(sim, aes(x=Position.in.alignment, y=sim$KU556804_chicken_AUS_2012_Igacovir...KY407556_chicken_CHN))+ geom_line(aes(x=Position.in.alignment,y=sim$KU556804_chicken_AUS_2012_Igacovir...KY407556_chicken_CHN, color='red')) + geom_line(aes(x=Position.in.alignment,y=sim$KU556804_AUS_2012_Igacovir...KY407557, color='blue'))
ggplot(sim, aes(x=Position.in.alignment, y=sim$KU556804_chicken_AUS_2012_Igacovir...KY407556_chicken_CHN))+ geom_line(aes(x=Position.in.alignment,y=sim$KU556804_chicken_AUS_2012_Igacovir...KY407556_chicken_CHN, label='KU556804_AUS2012vsKY407556_CHN', color='red')) + geom_line(aes(x=Position.in.alignment,y=sim$KU556804_AUS_2012_Igacovir...KY407557,label='KU556804_AUS2012vsKY407557_CHN', color='blue'))
ggplot(sim, aes(x=Position.in.alignment, y=sim$KU556804_chicken_AUS_2012_Igacovir...KY407556_chicken_CHN))+ geom_line(aes(x=Position.in.alignment,y=sim$KU556804_chicken_AUS_2012_Igacovir...KY407556_chicken_CHN, color='red'), label='KU556804_AUS2012vsKY407556_CHN') + geom_line(aes(x=Position.in.alignment,y=sim$KU556804_AUS_2012_Igacovir...KY407557,label='KU556804_AUS2012vsKY407557_CHN', color='blue'))
ggplot(sim, aes(x=Position.in.alignment)+ geom_line(aes(x=Position.in.alignment,y=sim$KU556804_chicken_AUS_2012_Igacovir...KY407556_chicken_CHN, color='red'), label='KU556804_AUS2012vsKY407556_CHN') + geom_line(aes(x=Position.in.alignment,y=sim$KU556804_AUS_2012_Igacovir...KY407557,label='KU556804_AUS2012vsKY407557_CHN', color='blue'))
ggplot(sim, aes(x=Position.in.alignment))+ geom_line(aes(x=Position.in.alignment,y=sim$KU556804_chicken_AUS_2012_Igacovir...KY407556_chicken_CHN, color='red'), label='KU556804_AUS2012vsKY407556_CHN') + geom_line(aes(x=Position.in.alignment,y=sim$KU556804_AUS_2012_Igacovir...KY407557,label='KU556804_AUS2012vsKY407557_CHN', color='blue'))
ggplot(sim, aes(x=Position.in.alignment))+ geom_line(aes(x=Position.in.alignment,y=sim$KU556804_chicken_AUS_2012_Igacovir...KY407556_chicken_CHN, color='red'), label='KU556804_AUS2012vsKY407556_CHN') + geom_line(aes(x=Position.in.alignment,y=sim$KU556804_AUS_2012_Igacovir...KY407557,label='KU556804_AUS2012vsKY407557_CHN', color='blue'))
ggplot(sim, aes(x=Position.in.alignment))+ geom_line(aes(x=Position.in.alignment,y=sim$KU556804_chicken_AUS_2012_Igacovir...KY407556_chicken_CHN) + geom_line(aes(x=Position.in.alignment,y=sim$KU556804_AUS_2012_Igacovir...KY407557))
ggplot(sim, aes(x=Position.in.alignment))+ geom_line(aes(x=Position.in.alignment,y=sim$KU556804_chicken_AUS_2012_Igacovir...KY407556_chicken_CHN)) + geom_line(aes(x=Position.in.alignment,y=sim$KU556804_AUS_2012_Igacovir...KY407557))
ggplot(sim, aes(x=Position.in.alignment))+ geom_line(aes(x=Position.in.alignment,y=sim$KU556804_chicken_AUS_2012_Igacovir...KY407556_chicken_CHN)) + geom_line(aes(x=Position.in.alignment,y=sim$KU556804_AUS_2012_Igacovir...KY407557))
ggplot(sim, aes(x=Position.in.alignment))+ geom_line(aes(x=Position.in.alignment,y=sim$KU556804_chicken_AUS_2012_Igacovir...KY407556_chicken_CHN, color='red')) + geom_line(aes(x=Position.in.alignment,y=sim$KU556804_AUS_2012_Igacovir...KY407557,color='blue'))
dir = 'D:/DATA/Virology/Coronaviruses/gb/alpha/'
df = read.csv(paste(dir,'Default. RNAFold_Sum.DAT',sep=''), header=TRUE, sep='\t')
ggplot(df, aes(x=Start, y=MFED))+ geom_line(aes(color=Group))
ggplot(df[df$Group=='Tegacovirus',], aes(x=Start, y=MFED))+ geom_line(aes(color=Sequence))
ggplot(df[df$Group=='Pedacovirus',], aes(x=Start, y=MFED))+ geom_line(aes(color=Sequence))
knitr::opts_chunk$set(echo = TRUE)
#library("spider")
library("ape")
library("seqinr")
#library("gridExtra")
#library(hexbin)
#library(grid)
library(ggplot2)
#library(sjstats)
#library(stats)
library(gplots)
library(colorRamps)
library(recDplot)
path_al = "D:/Users/User/Google Диск/Coronaviruses/gb/"
path_al = "C:/Users/alxva/Google Диск/Coronaviruses/gb/"
fig_path = "C:/Users/alxva/Google Диск/Coronaviruses/paper/figures/"
path = "D:/DATA/Virology/Coronaviruses/gb/recomb_simul_data/"
rec_al = read.dna(paste(path, "Alphacoronavirus_less_amb_1AB_0.2_0.9ng.fasta", sep=""), format="fasta", as.character=TRUE)
rec_al[rec_al=='-'] <- NA
length_al = length(rec_al[1,])
num_rec = length(rec_al[,1])
recomb_folder = paste(path, "recomb_alignments_halfs/", sep="")
distant = read.dna(paste(recomb_folder, 'distant_clades_1.fasta', sep=""), format="fasta")
l = plot_dist_test(distant, 1,length_al%/%2,length_al%/%2+1,length_al)
l[[1]]
distant = read.dna(paste(recomb_folder, 'distant_clades_2.fasta', sep=""), format="fasta")
l = plot_dist_test(distant, 1,length_al%/%2,length_al%/%2+1,length_al)
l[[1]]
distant = read.dna(paste(recomb_folder, 'distant_clades_3.fasta', sep=""), format="fasta")
l = plot_dist_test(distant, 1,length_al%/%2,length_al%/%2+1,length_al)
l[[1]]
#' Plot control Pairwise Distance Concordance Plot
#' Function plots pairwise nucleotide distance comparison plot.
#' Each dot corresponds to a pair of nucleotide distances between
#' the same pair of genomes in two genomic regions - odd sites and even sites of genome (see axis).
#' Returns list with ggplot, matrices of distances between pairs of seqences calculated for
#' odd and even sites
#' @param dna_object
#' @return list with ggplot object with control PDC plot, distance matrices for region 1 and 2
#' @export
plot_control = function(dna_object){
# subalignments for odd and even sites
al_odd=dna_object[1:length(dna_object[,1]), seq(from = 1, to = length(dna_object[1,]), by=2)]
al_even=dna_object[1:length(dna_object[,1]), seq(from = 2, to = length(dna_object[1,]), by=2)]
# distance matrices for each region
dna_sl_dist1 <-dist.gene(al_odd, method = "percentage",  pairwise.deletion = TRUE)
dna_sl_dist2 <-dist.gene(al_even, method = "percentage",  pairwise.deletion = TRUE)
# adding random noise to distances matrices' values
dist1= as.vector(dna_sl_dist1) + rnorm(length(dna_sl_dist1),mean = 0,sd= 0.001)
dist2= as.vector(dna_sl_dist2) + rnorm(length(dna_sl_dist2),mean = 0,sd= 0.0001)
# pairwise nucleotide distance comparison plot
dist_plot=ggplot(data.frame(dist1,dist2),aes(dist1,dist2))+stat_bin2d(binwidth = 0.001)+
scale_fill_gradientn(colours=c("blue","red"))+ theme(legend.justification=c(1,0), legend.position=c(1,0))+
xlab("odd sites")+ylab("even sites")
#+  geom_smooth(method='lm',formula=y~x)
return(list(dist_plot, dna_sl_dist1, dna_sl_dist2))
}
distant = read.dna(paste(recomb_folder, 'distant_clades_3.fasta', sep=""), format="fasta")
l = plot_dist_test(distant, 1,length_al%/%2,length_al%/%2+1,length_al)
l[[1]]
rmse_alpha = read.csv("D:/DATA/Virology/Coronaviruses/gb/RF_matrices/alpha_rmse.txt", sep=' ')
rmse_beta = read.csv("D:/DATA/Virology/Coronaviruses/gb/RF_matrices/beta_rmse.txt", sep=' ')
rmse_gamma = read.csv("D:/DATA/Virology/Coronaviruses/gb/RF_matrices/gamma_rmse.txt", sep=' ')
rmse_delta = read.csv("D:/DATA/Virology/Coronaviruses/gb/RF_matrices/delta_rmse.txt", sep=' ')
a_s5 = rmse_alpha[191:207]
a_s5[alpha_diag_log[,191:207]]=NA
a_s5_ar = array(a_s5)
a_s5_ar = a_s5_ar[!is.na(a_s5_ar)]
hist(a_s5_ar)
a_s3 = rmse_alpha[208:224]
a_s3[alpha_diag_log[,208:224]]=NA
a_s3_ar = array(a_s3)
a_s3_ar = a_s3_ar[!is.na(a_s3_ar)]
hist(a_s_ar)
hist(a_s3_ar)
wilcox.test(a_s5_ar, a_s3_ar, alternative = "two.sided")
a_s3
a_s3_ar
a_s5 = rmse_alpha[191:206]
a_s5[alpha_diag_log[,191:206]]=NA
a_s5_ar = array(a_s5)
a_s5_ar = a_s5_ar[!is.na(a_s5_ar)]
hist(a_s5_ar)
a_s3 = rmse_alpha[208:224]
a_s3[alpha_diag_log[,208:224]]=NA
a_s3_ar = array(a_s3)
a_s3_ar = a_s3_ar[!is.na(a_s3_ar)]
hist(a_s3_ar)
wilcox.test(a_s5_ar, a_s3_ar, alternative = "two.sided")
t.test(a_s5_ar,a_s3_ar)
compare_means = function(matr, s1,e1,s2,e2){
a_s5 = matr[s1:e1]
a_s5[alpha_diag_log[,s1:e1]]=NA
a_s5_ar = array(a_s5)
a_s5_ar = a_s5_ar[!is.na(a_s5_ar)]
hist(a_s5_ar)
a_s3 = matr[s2:e2]
a_s3[alpha_diag_log[,s2:e2]]=NA
a_s3_ar = array(a_s3)
a_s3_ar = a_s3_ar[!is.na(a_s3_ar)]
hist(a_s3_ar)
wilcox.test(a_s5_ar, a_s3_ar, alternative = "two.sided")
t.test(a_s5_ar,a_s3_ar)
}
compare_means(rmse_alpha, 191, 206, 207, 224)
t.test(a_s5_ar,a_s3_ar)
compare_means = function(matr, s1,e1,s2,e2){
a_s5 = matr[s1:e1]
a_s5[alpha_diag_log[,s1:e1]]=NA
a_s5_ar = array(a_s5)
a_s5_ar = a_s5_ar[!is.na(a_s5_ar)]
#hist(a_s5_ar)
a_s3 = matr[s2:e2]
a_s3[alpha_diag_log[,s2:e2]]=NA
a_s3_ar = array(a_s3)
a_s3_ar = a_s3_ar[!is.na(a_s3_ar)]
#hist(a_s3_ar)
wilcox.test(a_s5_ar, a_s3_ar, alternative = "two.sided")
#t.test(a_s5_ar,a_s3_ar)
}
compare_means(rmse_alpha, 191, 206, 207, 224)
compare_means(rmse_alpha, 191, 205, 206, 224)
compare_means(rmse_alpha, 191, 208, 208, 227)
compare_means(rmse_beta, 194, 210, 211, 227)
compare_means = function(matr, s1,e1,s2,e2){
diag_log = upper.tri(matr, diag = FALSE)
a_s5 = matr[s1:e1]
a_s5[diag_log[,s1:e1]]=NA
a_s5_ar = array(a_s5)
a_s5_ar = a_s5_ar[!is.na(a_s5_ar)]
#hist(a_s5_ar)
a_s3 = matr[s2:e2]
a_s3[diag_log[,s2:e2]]=NA
a_s3_ar = array(a_s3)
a_s3_ar = a_s3_ar[!is.na(a_s3_ar)]
#hist(a_s3_ar)
wilcox.test(a_s5_ar, a_s3_ar, alternative = "two.sided")
#t.test(a_s5_ar,a_s3_ar)
}
compare_means(rmse_beta, 194, 210, 211, 227)
compare_means(rmse_gamma, 196, 208, 209, 226)
compare_means(rmse_delta, 187, 200, 201, 218)
install.packages("roxygen2")
install.packages("seqinr")
setInternet2(use=True)
install.packages("roxygen2")
install.packages("roxygen2")
install.packages("ape")
file.edit('~/.Renviron')
options(internet.info = 0)
options(internet.info = 0)
