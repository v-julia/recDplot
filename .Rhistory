library("ape")
library("seqinr")
library(sjstats)
install.packages("sjstats")
count_pairs = function(df){
spl_df1 = str_split(df$`1`, '_', simplify = TRUE)
spl_df2 = str_split(df$`2`, '_', simplify = TRUE)
genogroups1 = paste(spl_df1[,4], spl_df1[,6], sep='_')
genogroups2 = paste(spl_df2[,4], spl_df2[,6], sep='_')
pairs = paste(genogroups1, genogroups2, sep=' vs ')
a = aggregate(data.frame(count = pairs), list(value = pairs), length)
return(a)
}
library(stringr)
library(colorRamps)
fig_path_nov = "J:/Virology/RNA_viruses/Norovirus/figures/"
path_al = "J:/Virology/RNA_viruses/Norovirus/"
noro_name = 'norovirus_ren.fasta'
noro = read.dna(paste(path_al, noro_name, sep=""), format="fasta", as.character=TRUE)
path_al = "D:/Virology/RNA_viruses/Norovirus/"
fig_path_nov = "D:/Virology/RNA_viruses/Norovirus/figures/"
noro_name = 'norovirus_ren.fasta'
noro = read.dna(paste(path_al, noro_name, sep=""), format="fasta", as.character=TRUE)
noro[noro=='-'] <- NA
svg(file=paste(fig_path_nov, "noro_rmse_50_600.svg", sep=""))
heatmap.2(as.matrix(noro_rmse50_600[nrow(noro_rmse50_600):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="Norovirus(window=600,step=50),",tracecol=NA)
noro_rmse50_600 = plot_rmse(noro, 50, 600,"pdist","pairwise")
library("recDplot")
library(ggplot2)
library("ape")
library("seqinr")
library(sjstats)
library("recDplot")
library(ggplot2)
library("ape")
library("seqinr")
library("sjstats")
library("sjstats")
library("spider")
library("gridExtra")
library(gplots)
library(colorRamps)
library(stringr)
library("spider")
rmse('')
rmse()
sjstats::rmse()
install.packages("bayestestR")
library("sjstats")
install.packages("rlang")
library("sjstats")
sessionInfo()
install.packages("rlang")
library("sjstats")
devtools::install_github("r-lib/rlang", build_vignettes = TRUE)
library(ggplot2)
library("ape")
library("seqinr")
library(sjstats)
library("spider")
library("gridExtra")
#library(hexbin)
library(grid)
library(gplots)
library(colorRamps)
library(stringr)
library(dplyr)
fig_path = "D:/MY_FILES/DATA/Lukashev/RNA_viruses/Lagovirus/figures/"
path_al = "D:/MY_FILES/DATA/Lukashev/RNA_viruses/Lagovirus/"
path_al = "D:/Virology/RNA_viruses/Lagovirus/"
lago_name = 'Lagovirus_full_aln_0.5_less_amb_genotyped.fasta'
lago = read.dna(paste(path_al, lago_name, sep=""), format="fasta", as.character=TRUE)
lago[lago=='-'] <- NA
dist_df_lago_list = plot_PDCP_control(lago, 1, 3000, 3001, 7000)
plot_PDCP_control = function(dna_object, st1,e1,st2,e2){
# subalignments for odd and even sites
al_odd=dna_object[1:length(dna_object[,1]), seq(from = 1, to = length(dna_object[1,]), by=2)]
al_even=dna_object[1:length(dna_object[,1]), seq(from = 2, to = length(dna_object[1,]), by=2)]
# distance matrices for each region
dna_sl_dist1_odd <-dist.gene(al_odd, method = "percentage",  pairwise.deletion = TRUE)
dna_sl_dist2_even <-dist.gene(al_even, method = "percentage",  pairwise.deletion = TRUE)
# adding random noise to distances matrices' values
dist1_odd = as.vector(dna_sl_dist1_odd) + rnorm(length(dna_sl_dist1_odd),mean = 0,sd= 0.0001)
dist2_even = as.vector(dna_sl_dist2_even) + rnorm(length(dna_sl_dist2_even),mean = 0,sd= 0.0001)
dna_sl1=dna_object[1:length(dna_object[,1]), seq(from = st1, to = e1, by=1)]
dna_sl2=dna_object[1:length(dna_object[,1]), seq(from = st2, to = e2, by=1)]
# distance matrices for each region
dna_sl_dist1 <-dist.gene(dna_sl1, method = "percentage",  pairwise.deletion = TRUE)
dna_sl_dist2 <-dist.gene(dna_sl2, method = "percentage",  pairwise.deletion = TRUE)
# adding random noise to distances matrices' values
dist1= as.vector(dna_sl_dist1) + rnorm(length(dna_sl_dist1),mean = 0,sd= 0.0001)
dist2= as.vector(dna_sl_dist2) + rnorm(length(dna_sl_dist2),mean = 0,sd= 0.0001)
dist_df = data.frame(dist1_odd, dist2_even, dist1, dist2)
ggplot() +  stat_bin2d(data = dist_df, aes(dist1, dist2), binwidth = 0.003) + scale_fill_gradientn(colours=c("blue","red")) +
stat_bin2d(data = dist_df, aes(dist1_odd, dist2_even, alpha=0.5), binwidth = 0.003, color='black') +
theme(legend.justification=c(1,0), legend.position=c(1,0)) +
xlab(paste(toString(st1),toString(e1),sep=":"))+ylab(paste(toString(st2),toString(e2),sep=":"))
ggplot() +  geom_point(data = dist_df, aes(dist1, dist2), color="red") +
geom_point(data = dist_df, aes(dist1_odd, dist2_even, alpha=0.5))
return(dist_df)
}
dist_df_lago_list = plot_PDCP_control(lago, 1, 3000, 3001, 7000)
df1 = data.frame(dist_df_lago_list$dist1, dist_df_lago_list$dist2, factor="real")
colnames(df1) = c('dist1', 'dist2')
df2 =  data.frame(dist_df_lago_list$dist1_odd, dist_df_lago_list$dist2_even, factor="control")
colnames(df2) = c('dist1', 'dist2')
d = rbind(df1, df2)
colnames(d) = c('dist1', 'dist2', 'cond')
ggplot(data = d, aes(dist1, dist2)) +  geom_point(aes(color=cond)) +  scale_color_manual(values = c("dodgerblue4", "dimgrey"))+
#geom_point(data = d, aes(dist1, dist2), alpha=0.5, color="dimgrey")+
theme(legend.justification=c(1,0), legend.position=c(1,0)) +
xlab(paste(toString(1),toString(3000),sep=":"))+ylab(paste(toString(3001),toString(7000),sep=":"))+
guides(color = guide_legend(title = ""))
ggplot() +  stat_bin2d(data = dist_df_lago, aes(dist1, dist2), binwidth = 0.003) + scale_fill_gradientn(colours=c("blue","red")) +
stat_bin2d(data = dist_df_lago, aes(dist1_odd, dist2_even, alpha=0.5), binwidth = 0.003, color='black') +
theme(legend.justification=c(1,0), legend.position=c(1,0)) +
xlab(paste(toString(1),toString(3000),sep=":"))+ylab(paste(toString(3001),toString(7000),sep=":"))
ggplot() +  stat_bin2d(data = dist_df_lago_list, aes(dist1, dist2), binwidth = 0.003) + scale_fill_gradientn(colours=c("blue","red")) +
stat_bin2d(data = dist_df_lago_list, aes(dist1_odd, dist2_even, alpha=0.5), binwidth = 0.003, color='black') +
theme(legend.justification=c(1,0), legend.position=c(1,0)) +
xlab(paste(toString(1),toString(3000),sep=":"))+ylab(paste(toString(3001),toString(7000),sep=":"))
ggplot() +  stat_bin2d(data = dist_df_lago_list, aes(dist1, dist2), binwidth = 0.003) + scale_fill_gradientn(colours=c("blue","red")) +
stat_bin2d(data = dist_df_lago_list, aes(dist1_odd, dist2_even), binwidth = 0.003, color='black') +
theme(legend.justification=c(1,0), legend.position=c(1,0)) +
xlab(paste(toString(1),toString(3000),sep=":"))+ylab(paste(toString(3001),toString(7000),sep=":"))
ggplot(data = d, aes(dist1, dist2)) +  stat_bin2d(aes(color=cond), binwidth = 0.003) + scale_fill_gradientn(colours=c("blue","red")) +
#stat_bin2d(data = dist_df_lago_list, aes(dist1_odd, dist2_even), binwidth = 0.003, color='black') +
theme(legend.justification=c(1,0), legend.position=c(1,0)) +
xlab(paste(toString(1),toString(3000),sep=":"))+ylab(paste(toString(3001),toString(7000),sep=":"))
ggplot(data = d, aes(dist1, dist2)) +  stat_bin2d(aes(color=cond), binwidth = 0.003) + #scale_fill_gradientn(colours=c("blue","red")) +
#stat_bin2d(data = dist_df_lago_list, aes(dist1_odd, dist2_even), binwidth = 0.003, color='black') +
theme(legend.justification=c(1,0), legend.position=c(1,0)) +
xlab(paste(toString(1),toString(3000),sep=":"))+ylab(paste(toString(3001),toString(7000),sep=":"))
ggplot(data=dist_df_lago_list) +
stat_bin2d(aes(x=dist1, y=dist2), fill="#002BFF") +
stat_bin2d(aes(x=dist1_odd, y=dist2_even, alpha=..count..), fill="#FFD500") +
guides(fill=FALSE, alpha=FALSE) +
xlab("Range Transformed Units")
ggplot(data=dist_df_lago_list) +
stat_bin2d(aes(x=dist1, y=dist2), fill="#002BFF") +
stat_bin2d(aes(x=dist1_odd, y=dist2_even), fill="#FFD500") +
guides(fill=FALSE, alpha=FALSE) +
xlab("Range Transformed Units")
ggplot(data=dist_df_lago_list) +
stat_bin2d(aes(x=dist1, y=dist2, alpha=..count..), fill="#002BFF") +
stat_bin2d(aes(x=dist1_odd, y=dist2_even, alpha=..count..), fill="#FFD500") +
guides(fill=FALSE, alpha=FALSE) +
xlab("Range Transformed Units")
library(recDplot)
library("recDplot")
fig_path = "J:/Virology/RNA_viruses/Lagovirus/figures/"
fig_path = "D:/Virology/RNA_viruses/Lagovirus/figures/"
path_al = "D:/Virology/RNA_viruses/Lagovirus/"
lago_name = 'Lagovirus_full_aln_0.5_less_amb_genotyped.fasta'
lago = read.dna(paste(path_al, lago_name, sep=""), format="fasta", as.character=TRUE)
lago[lago=='-'] <- NA
l = plot_dist_test(lago, 1,7044,7045,7401)
l[[1]]
l = plot_PDCP_control(lago, 1,7044,7045,7401)
l = plot_PDCP_control(lago, 1,7044,7045,7401)
l[[1]]
l[[2]]
View(l)
l = plot_PDCP_control(lago, 1,7044,7045,7401)
library(recDplot)
library("recDplot")
path_al = "D:/Virology/RNA_viruses/Lagovirus/"
lago_name = 'Lagovirus_full_aln_0.5_less_amb_genotyped.fasta'
lago = read.dna(paste(path_al, lago_name, sep=""), format="fasta", as.character=TRUE)
lago[lago=='-'] <- NA
l = plot_PDCP_control(lago, 1,7044,7045,7401)
library(recDplot)
library("recDplot")
library(ggplot2)
library("ape")
library("seqinr")
library(sjstats)
library("spider")
library("gridExtra")
#library(hexbin)
library(grid)
library(gplots)
library(colorRamps)
library(stringr)
fig_path = "D:/Virology/RNA_viruses/Lagovirus/figures/"
path_al = "D:/Virology/RNA_viruses/Lagovirus/"
lago_name = 'Lagovirus_full_aln_0.5_less_amb_genotyped.fasta'
lago = read.dna(paste(path_al, lago_name, sep=""), format="fasta", as.character=TRUE)
lago[lago=='-'] <- NA
l = plot_PDCP_control(lago, 1,7044,7045,7401)
plot_PDCP_control = function(dna_object, st1,e1,st2,e2){
# subalignments for odd and even sites
al_odd=dna_object[1:length(dna_object[,1]), seq(from = 1, to = length(dna_object[1,]), by=2)]
al_even=dna_object[1:length(dna_object[,1]), seq(from = 2, to = length(dna_object[1,]), by=2)]
# distance matrices for each region
dna_sl_dist1_odd <-dist.gene(al_odd, method = "percentage",  pairwise.deletion = TRUE)
dna_sl_dist2_even <-dist.gene(al_even, method = "percentage",  pairwise.deletion = TRUE)
# adding random noise to distances matrices' values
dist1_odd = as.vector(dna_sl_dist1_odd) + rnorm(length(dna_sl_dist1_odd),mean = 0,sd= 0.0001)
dist2_even = as.vector(dna_sl_dist2_even) + rnorm(length(dna_sl_dist2_even),mean = 0,sd= 0.0001)
dna_sl1=dna_object[1:length(dna_object[,1]), seq(from = st1, to = e1, by=1)]
dna_sl2=dna_object[1:length(dna_object[,1]), seq(from = st2, to = e2, by=1)]
# distance matrices for each region
dna_sl_dist1 <-dist.gene(dna_sl1, method = "percentage",  pairwise.deletion = TRUE)
dna_sl_dist2 <-dist.gene(dna_sl2, method = "percentage",  pairwise.deletion = TRUE)
# adding random noise to distances matrices' values
dist1= as.vector(dna_sl_dist1) + rnorm(length(dna_sl_dist1),mean = 0,sd= 0.0001)
dist2= as.vector(dna_sl_dist2) + rnorm(length(dna_sl_dist2),mean = 0,sd= 0.0001)
df1 = data.frame(dist1, dist2, factor="real")
colnames(df1) = c('dist1', 'dist2')
df2 =  data.frame(dist1_odd, dist2_even, factor="control")
colnames(df2) = c('dist1', 'dist2')
df = rbind(df1, df2)
colnames(df) = c('dist1', 'dist2', 'cond')
PDCP = ggplot(data = df, aes(dist1, dist2)) +  geom_point(aes(color=cond)) +  scale_color_manual(values = c("dimgrey", "dodgerblue4"))+
theme(legend.justification=c(1,0), legend.position=c(1,0)) +
xlab(paste(toString(st1),toString(e1),sep=":"))+ylab(paste(toString(st2),toString(e2),sep=":"))+
guides(color = guide_legend(title = ""))
return(list(PDCP, df))
}
l = plot_PDCP_control(lago, 1,7044,7045,7401)
l[1]
l = plot_PDCP_control(lago, 1,5298,5299,7401)
l[[1]]
library(recDplot)
library("recDplot")
library(ggplot2)
library("ape")
library("seqinr")
library(sjstats)
library("spider")
library("gridExtra")
#library(hexbin)
library(grid)
library(gplots)
library(colorRamps)
library(stringr)
path_al = "D:/Virology/RNA_viruses/Lagovirus/"
lago_name = 'Lagovirus_full_aln_0.5_less_amb_genotyped.fasta'
lago = read.dna(paste(path_al, lago_name, sep=""), format="fasta", as.character=TRUE)
lago[lago=='-'] <- NA
l = plot_PDCP_control(lago, 1,7044,7045,7401)
l = plot_PDCP_control(lago, 1,7044,7045,7401)
library(recDplot)
library(recDplot)
library("recDplot")
library(ggplot2)
library("ape")
library("seqinr")
library(sjstats)
library("spider")
library("gridExtra")
#library(hexbin)
library(grid)
library(gplots)
library(colorRamps)
library(stringr)
l = plot_PDCP_control(lago, 1,7044,7045,7401)
l = plot_PDCP_control(lago, 1,7044,7045,7401)
l[1]
library("recDplot")
path_al = "D:/Virology/RNA_viruses/"
fig_path = "D:/Virology/RNA_viruses/PDCPwithControls/"
fig_path = "D:/Virology/RNA_viruses/PDCPwithControls/"
aln_name = paste(path_al, "norovirus_full_aln_100gp_0.5_genotyped.fasta", sep="")
noro = read.dna(paste(path_al, aln_name, sep=""), format="fasta", as.character=TRUE)
paste(path_al, "norovirus_full_aln_100gp_0.5_genotyped.fasta", sep="")
aln_name = paste(path_al,"Norovirus","norovirus_full_aln_100gp_0.5_genotyped.fasta", sep="")
noro = read.dna(paste(path_al, aln_name, sep=""), format="fasta", as.character=TRUE)
aln_name = paste("Norovirus","norovirus_full_aln_100gp_0.5_genotyped.fasta", sep="/")
noro = read.dna(paste(path_al, aln_name, sep=""), format="fasta", as.character=TRUE)
noro[noro=='-'] <- NA
list_regs_NoV <- list(
list(n1="Nonstructural region",s1=1,e1=5082,n2="Structural region",s2=5083,e2=7431),
list(n1="5' half of nonstructural region",s1=1,e1=2541,n2="3' half of nonstructural region",s2=2542,e2=5082),
list(n1="VP1",s1=5083,e1=6687,n2="VP2",s2=6688,e2=7431)
list_regs_NoV <- list(
list(n1="Nonstructural region",s1=1,e1=5082,n2="Structural region",s2=5083,e2=7431),
list(n1="5' half of nonstructural region",s1=1,e1=2541,n2="3' half of nonstructural region",s2=2542,e2=5082),
list(n1="VP1",s1=5083,e1=6687,n2="VP2",s2=6688,e2=7431)
)
list_regs_NoV <- list(
list(n1="NS",s1=1,e1=5082,n2="S",s2=5083,e2=7431),
list(n1="NS",s1=1,e1=2541,n2="NS",s2=2542,e2=5082),
list(n1="VP1",s1=5083,e1=6687,n2="VP2",s2=6688,e2=7431)
)
for(reg in list_regs_NoV){
print(paste('Norovirus, all genogroups', reg$n1,reg$n2, sep=', '))
l <-  plot_PDCP_control(noro, reg$s1, reg$e1, reg$s2, reg$e2)
ggsave(file=paste("fig_path/NoV__",paste(reg$n1, reg$n2, sep="_vs_"), ".svg", sep=""),
plot=l[[1]])
}
install.packages("svglite")
library(svglite)
for(reg in list_regs_NoV){
print(paste('Norovirus, all genogroups', reg$n1,reg$n2, sep=', '))
l <-  plot_PDCP_control(noro, reg$s1, reg$e1, reg$s2, reg$e2)
ggsave(file=paste("fig_path/NoV__",paste(reg$n1, reg$n2, sep="_vs_"), ".svg", sep=""),
plot=l[[1]])
}
for(reg in list_regs_NoV){
print(paste('Norovirus, all genogroups', reg$n1,reg$n2, sep=', '))
l <-  plot_PDCP_control(noro, reg$s1, reg$e1, reg$s2, reg$e2)
ggsave(file=paste(fig_path,"NoV_",paste(reg$n1, reg$n2, sep="_vs_"), ".svg", sep=""),
plot=l[[1]])
}
for(reg in list_regs_NoV){
print(paste('Norovirus, all genogroups', reg$n1,reg$n2, sep=', '))
l <-  plot_PDCP_control(noro, reg$s1, reg$e1, reg$s2, reg$e2)
ggsave(file=paste(fig_path,"NoV_",paste(reg$n1, reg$n2, sep="_vs_"), ".png", sep=""),
plot=l[[1]])
}
aln_name = paste("Sapovirus","sapovirus_genomes_full_aln_100gp_0.5_genotyped.fasta", sep="/")
sapo = read.dna(paste(path_al, aln_name, sep=""), format="fasta", as.character=TRUE)
noro[sapo=='-'] <- NA
list_regs_SaV <- list(
list(n1="NS",s1=1,e1=5091,n2="S",s2=5092,e2=7191),
list(n1="NS",s1=1,e1=2541,n2="NS",s2=2542,e2=5091),
list(n1="VP1",s1=5092,e1=6711,n2="VP2",s2=6712,e2=7191)
)
for(reg in list_regs_SaV){
print(paste('Sapovirus', reg$n1,reg$n2, sep=', '))
l <-  plot_PDCP_control(sapo, reg$s1, reg$e1, reg$s2, reg$e2)
ggsave(file=paste(fig_path,"SaV_",paste(reg$n1, reg$n2, sep="_vs_"), ".png", sep=""),
plot=l[[1]])
}
aln_name = paste("Sapovirus","sapovirus_genomes_full_aln_100gp_0.5_genotyped.fasta", sep="/")
sapo = read.dna(paste(path_al, aln_name, sep=""), format="fasta", as.character=TRUE)
sapo[sapo=='-'] <- NA
list_regs_SaV <- list(
list(n1="NS",s1=1,e1=5091,n2="S",s2=5092,e2=7191),
list(n1="NS",s1=1,e1=2541,n2="NS",s2=2542,e2=5091),
list(n1="VP1",s1=5092,e1=6711,n2="VP2",s2=6712,e2=7191)
)
for(reg in list_regs_SaV){
print(paste('Sapovirus', reg$n1,reg$n2, sep=', '))
l <-  plot_PDCP_control(sapo, reg$s1, reg$e1, reg$s2, reg$e2)
ggsave(file=paste(fig_path,"SaV_",paste(reg$n1, reg$n2, sep="_vs_"), ".png", sep=""),
plot=l[[1]])
}
aln_name = paste("Lagovirus","Lagovirus_full_aln_0.5_less_amb_genotyped.fasta", sep="/")
lago = read.dna(paste(path_al, aln_name, sep=""), format="fasta", as.character=TRUE)
lago[lago=='-'] <- NA
list_regs_LaV <- list(
list(n1="NS",s1=1,e1=5298,n2="S",s2=5299,e2=7401),
list(n1="NS",s1=1,e1=2649,n2="NS",s2=2650,e2=5298),
list(n1="VP1",s1=5299,e1=7044,n2="VP2",s2=7045,e2=7401)
)
for(reg in list_regs_LaV){
print(paste('Lagovirus', reg$n1,reg$n2, sep=', '))
l <-  plot_PDCP_control(lago, reg$s1, reg$e1, reg$s2, reg$e2)
ggsave(file=paste(fig_path,"LaV_",paste(reg$n1, reg$n2, sep="_vs_"), ".png", sep=""),
plot=l[[1]])
}
aln_name = paste("Astrovirus","mav_all_1AB2_aln_noout_gt_trim.fasta", sep="/")
mav = read.dna(paste(path_al, aln_name, sep=""), format="fasta", as.character=TRUE)
mav[mav=='-'] <- NA
list_regs_MAV <- list(
list(n1="NS",s1=1,e1=3411,n2="S",s2=3412,e2=4764),
list(n1="NS",s1=1,e1=1956,n2="NS",s2=1957,e2=3411),
list(n1="VP1",s1=3412,e1=4000,n2="VP2",s2=4001,e2=4764)
)
for(reg in list_regs_MAV){
print(paste('Mamastrovirus', reg$n1,reg$n2, sep=', '))
l <-  plot_PDCP_control(mav, reg$s1, reg$e1, reg$s2, reg$e2)
ggsave(file=paste(fig_path,"MAV_",paste(reg$n1, reg$n2, sep="_vs_"), ".png", sep=""),
plot=l[[1]])
}
aln_name = paste("Picornaviruses","fmdv_full_aln_genotyped.fasta", sep="/")
FMDV = read.dna(paste(path_al, aln_name, sep=""), format="fasta", as.character=TRUE)
FMDV[FMDV=='-'] <- NA
list_regs_FMDV <- list(
list(n1="NS",s1=2800,e1=6990,n2="S",s2=604,e2=2799),
list(n1="NS",s1=2800,e1=4269,n2="NS",s2=4270,e2=6990),
list(n1="VP2-VP4",s1=604,e1=1512,n2="VP3-VP1",s2=1513,e2=2799)
)
for(reg in list_regs_FMDV){
print(paste('Aphthovirus', reg$n1,reg$n2, sep=', '))
l <-  plot_PDCP_control(AphV, reg$s1, reg$e1, reg$s2, reg$e2)
ggsave(file=paste(fig_path,"FMDV_",paste(reg$n1, reg$n2, sep="_vs_"), ".png", sep=""),
plot=l[[1]])
}
aln_name = paste("Picornaviruses","fmdv_full_aln_genotyped.fasta", sep="/")
FMDV = read.dna(paste(path_al, aln_name, sep=""), format="fasta", as.character=TRUE)
FMDV[FMDV=='-'] <- NA
list_regs_FMDV <- list(
list(n1="NS",s1=2800,e1=6990,n2="S",s2=604,e2=2799),
list(n1="NS",s1=2800,e1=4269,n2="NS",s2=4270,e2=6990),
list(n1="VP2-VP4",s1=604,e1=1512,n2="VP3-VP1",s2=1513,e2=2799)
)
for(reg in list_regs_FMDV){
print(paste('Aphthovirus', reg$n1,reg$n2, sep=', '))
l <-  plot_PDCP_control(FMDV, reg$s1, reg$e1, reg$s2, reg$e2)
ggsave(file=paste(fig_path,"FMDV_",paste(reg$n1, reg$n2, sep="_vs_"), ".png", sep=""),
plot=l[[1]])
}
aln_name = paste("Enterovirus","HEV_tr_aln_rt.fasta", sep="/")
HEV = read.dna(paste(path_al, aln_name, sep=""), format="fasta", as.character=TRUE)
HEV[HEV=='-'] <- NA
list_regs_HEV <- list(
list(n1="NS",s1=2977,e1=6723,n2="S",s2=1,e2=2976),
list(n1="NS",s1=2977,e1=4716,n2="NS",s2=4717,e2=6723),
list(n1="VP2-VP4",s1=1,e1=1134,n2="VP3-VP1",s2=1135,e2=2977)
)
for(reg in list_regs_HEV){
print(paste('Enterovirus A-D', reg$n1,reg$n2, sep=', '))
l <-  plot_PDCP_control(HEV, reg$s1, reg$e1, reg$s2, reg$e2)
ggsave(file=paste(fig_path,"HEV_",paste(reg$n1, reg$n2, sep="_vs_"), ".png", sep=""),
plot=l[[1]])
}
library("recDplot")
library(reticulate)
library(colorRamps)
library(svglite)
path_al = "D:/Virology/RNA_viruses/"
fig_path = "D:/Virology/RNA_viruses/PDCPwithControls/"
aln_name = paste("Norovirus","norovirus_full_aln_100gp_0.5_genotyped.fasta", sep="/")
noro = read.dna(paste(path_al, aln_name, sep=""), format="fasta", as.character=TRUE)
noro[noro=='-'] <- NA
list_regs_NoV <- list(
list(n1="Nonstructural region",s1=1,e1=5082,n2="Structural region",s2=5083,e2=7431),
list(n1="5' half of nonstructural region",s1=1,e1=2541,n2="3' half of nonstructural region",s2=2542,e2=5082),
list(n1="VP1",s1=5083,e1=6687,n2="VP2",s2=6688,e2=7431)
)
list_regs_NoV <- list(
list(n1="NS",s1=1,e1=5082,n2="S",s2=5083,e2=7431),
list(n1="NS",s1=1,e1=2541,n2="NS",s2=2542,e2=5082),
list(n1="VP1",s1=5083,e1=6687,n2="VP2",s2=6688,e2=7431)
)
for(reg in list_regs_NoV){
print(paste('Norovirus, all genogroups', reg$n1,reg$n2, sep=', '))
l <-  plot_PDCP_control(noro, reg$s1, reg$e1, reg$s2, reg$e2)
ggsave(file=paste(fig_path,"NoV_",paste(reg$n1, reg$n2, sep="_vs_"), ".png", sep=""),
plot=l[[1]])
}
aln_name = paste("Sapovirus","sapovirus_genomes_full_aln_100gp_0.5_genotyped.fasta", sep="/")
sapo = read.dna(paste(path_al, aln_name, sep=""), format="fasta", as.character=TRUE)
sapo[sapo=='-'] <- NA
list_regs_SaV <- list(
list(n1="NS",s1=1,e1=5091,n2="S",s2=5092,e2=7191),
list(n1="NS",s1=1,e1=2541,n2="NS",s2=2542,e2=5091),
list(n1="VP1",s1=5092,e1=6711,n2="VP2",s2=6712,e2=7191)
)
for(reg in list_regs_SaV){
print(paste('Sapovirus', reg$n1,reg$n2, sep=', '))
l <-  plot_PDCP_control(sapo, reg$s1, reg$e1, reg$s2, reg$e2)
ggsave(file=paste(fig_path,"SaV_",paste(reg$n1, reg$n2, sep="_vs_"), ".png", sep=""),
plot=l[[1]])
}
library(recDplot)
library("recDplot")
library(reticulate)
library(colorRamps)
library(svglite)
path_al = "D:/Virology/RNA_viruses/"
fig_path = "D:/Virology/RNA_viruses/PDCPwithControls/"
aln_name = paste("Sapovirus","sapovirus_genomes_full_aln_100gp_0.5_genotyped.fasta", sep="/")
sapo = read.dna(paste(path_al, aln_name, sep=""), format="fasta", as.character=TRUE)
sapo[sapo=='-'] <- NA
list_regs_SaV <- list(
list(n1="NS",s1=1,e1=5091,n2="S",s2=5092,e2=7191),
list(n1="NS",s1=1,e1=2541,n2="NS",s2=2542,e2=5091),
list(n1="VP1",s1=5092,e1=6711,n2="VP2",s2=6712,e2=7191)
)
for(reg in list_regs_SaV){
print(paste('Sapovirus', reg$n1,reg$n2, sep=', '))
l <-  plot_PDCP_control(sapo, reg$s1, reg$e1, reg$s2, reg$e2)
ggsave(file=paste(fig_path,"SaV_",paste(reg$n1, reg$n2, sep="_vs_"), ".png", sep=""),
plot=l[[1]])
}
aln_name = paste("Lagovirus","Lagovirus_full_aln_0.5_less_amb_genotyped.fasta", sep="/")
lago = read.dna(paste(path_al, aln_name, sep=""), format="fasta", as.character=TRUE)
lago[lago=='-'] <- NA
list_regs_LaV <- list(
list(n1="NS",s1=1,e1=5298,n2="S",s2=5299,e2=7401),
list(n1="NS",s1=1,e1=2649,n2="NS",s2=2650,e2=5298),
list(n1="VP1",s1=5299,e1=7044,n2="VP2",s2=7045,e2=7401)
)
for(reg in list_regs_LaV){
print(paste('Lagovirus', reg$n1,reg$n2, sep=', '))
l <-  plot_PDCP_control(lago, reg$s1, reg$e1, reg$s2, reg$e2)
ggsave(file=paste(fig_path,"LaV_",paste(reg$n1, reg$n2, sep="_vs_"), ".png", sep=""),
plot=l[[1]])
}
aln_name = paste("Astrovirus","mav_all_1AB2_aln_noout_gt_trim.fasta", sep="/")
mav = read.dna(paste(path_al, aln_name, sep=""), format="fasta", as.character=TRUE)
mav[mav=='-'] <- NA
list_regs_MAV <- list(
list(n1="NS",s1=1,e1=3411,n2="S",s2=3412,e2=4764),
list(n1="NS",s1=1,e1=1956,n2="NS",s2=1957,e2=3411),
list(n1="VP1",s1=3412,e1=4000,n2="VP2",s2=4001,e2=4764)
)
for(reg in list_regs_MAV){
print(paste('Mamastrovirus', reg$n1,reg$n2, sep=', '))
l <-  plot_PDCP_control(mav, reg$s1, reg$e1, reg$s2, reg$e2)
ggsave(file=paste(fig_path,"MAV_",paste(reg$n1, reg$n2, sep="_vs_"), ".png", sep=""),
plot=l[[1]])
}
aln_name = paste("Picornaviruses","fmdv_full_aln_genotyped.fasta", sep="/")
FMDV = read.dna(paste(path_al, aln_name, sep=""), format="fasta", as.character=TRUE)
FMDV[FMDV=='-'] <- NA
list_regs_FMDV <- list(
list(n1="NS",s1=2800,e1=6990,n2="S",s2=604,e2=2799),
list(n1="NS",s1=2800,e1=4269,n2="NS",s2=4270,e2=6990),
list(n1="VP2-VP4",s1=604,e1=1512,n2="VP3-VP1",s2=1513,e2=2799)
)
for(reg in list_regs_FMDV){
print(paste('Aphthovirus', reg$n1,reg$n2, sep=', '))
l <-  plot_PDCP_control(FMDV, reg$s1, reg$e1, reg$s2, reg$e2)
ggsave(file=paste(fig_path,"FMDV_",paste(reg$n1, reg$n2, sep="_vs_"), ".png", sep=""),
plot=l[[1]])
}
