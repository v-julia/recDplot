library("spider")
library("gridExtra")
#library(hexbin)
library(grid)
library(gplots)
library(colorRamps)
library("recDplot")
library(ggplot2)
library(reticulate)
library("ape")
library("seqinr")
library(sjstats)
library("spider")
library("gridExtra")
#library(hexbin)
library(grid)
library(gplots)
library(colorRamps)
#path_figure = "D:/Users/User/Google Диск/Coronaviruses/paper/figures/"
path_figure = "C:/Users/alxva/Google Диск/Coronaviruses/paper/figures2/"
#path_al = "D:/Users/User/Google Диск/Coronaviruses/gb/"
path_al = "C:/Users/alxva/Google Диск/Coronaviruses/gb/"
alpha_name = 'Alphacoronavirus_less_amb_1ABSEMN_aln_1.0_0.9ng.fasta'
alpha = read.dna(paste(path_al, 'alpha/', alpha_name, sep=""), format="fasta", as.character=TRUE)
alpha[alpha=='-'] <- NA
#alpha_rmse = plot_rmse(alpha, 50, 500,"pdist","pairwise")
alpha_rmse800 = plot_rmse(alpha, 100, 800,"pdist","pairwise")
library(recDplot)
library("recDplot")
library(ggplot2)
library(reticulate)
library("ape")
library("seqinr")
library(sjstats)
library("spider")
library("gridExtra")
#library(hexbin)
library(grid)
library(gplots)
library(colorRamps)
pdf.options(encoding = 'CP1250')
fig_path = "C:/Users/alxva/Google Диск/Coronaviruses/paper/figures2/"
#path_figure = "D:/Users/User/Google Диск/Coronaviruses/paper/figures/"
path_figure = "C:/Users/alxva/Google Диск/Coronaviruses/paper/figures2/"
#path_al = "D:/Users/User/Google Диск/Coronaviruses/gb/"
path_al = "C:/Users/alxva/Google Диск/Coronaviruses/gb/"
alpha_name = 'Alphacoronavirus_less_amb_1ABSEMN_aln_1.0_0.9ng.fasta'
alpha = read.dna(paste(path_al, 'alpha/', alpha_name, sep=""), format="fasta", as.character=TRUE)
alpha[alpha=='-'] <- NA
alpha_rmse800 = plot_rmse(alpha, 100, 800,"pdist","pairwise")
heatmap.2(as.matrix(alpha_rmse800[nrow(alpha_rmse800):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="Alpha, rmse (window=800,step=100)",tracecol=NA)
library(recDplot)
beta_name = 'Betacoronavirus_less_amb_1ABSEMN_aln_1.0_0.9ng.fasta'
beta = read.dna(paste(path_al, 'beta/', beta_name, sep=""), format="fasta", as.character=TRUE)
beta[beta=='-'] <- NA
#beta_rmse1000 = plot_rmse(beta, 100, 1000,"pdist","pairwise")
beta_rmse800 = plot_rmse(beta, 100, 800,"pdist","pairwise")
beta_name = 'Betacoronavirus_less_amb_1ABSEMN_aln_1.0_0.9ng — копия'
beta = read.dna(paste(path_al, 'beta/', beta_name, sep=""), format="fasta", as.character=TRUE)
library("recDplot")
library(ggplot2)
library(reticulate)
library("ape")
library("seqinr")
library(sjstats)
library("spider")
library("gridExtra")
#library(hexbin)
library(grid)
library(gplots)
library(colorRamps)
pdf.options(encoding = 'CP1250')
fig_path = "C:/Users/alxva/Google Диск/Coronaviruses/paper/figures2/"
path_al = "D:/GoogleDrive/Coronaviruses/gb/"
path_al = "C:/Users/alxva/Google Диск/Coronaviruses/gb/"
alpha_name = 'Alphacoronavirus_less_amb_1ABSEMN_aln_0.7ng_1.0.fasta'
alpha = read.dna(paste(path_al, 'alpha/', alpha_name, sep=""), format="fasta")
#path_figure = "D:/Users/User/Google Диск/Coronaviruses/paper/figures/"
path_figure = "C:/Users/alxva/Google Диск/Coronaviruses/paper/figures2/"
#path_al = "D:/Users/User/Google Диск/Coronaviruses/gb/"
path_al = "C:/Users/alxva/Google Диск/Coronaviruses/gb/"
alpha_name = 'Alphacoronavirus_less_amb_1ABSEMN_aln_1.0_0.9ng.fasta'
alpha = read.dna(paste(path_al, 'alpha/', alpha_name, sep=""), format="fasta", as.character=TRUE)
alpha[alpha=='-'] <- NA
beta_name = 'Betacoronavirus_less_amb_1ABSEMN_aln_1.0_0.9ng — копия'
beta = read.dna(paste(path_al, 'beta/', beta_name, sep=""), format="fasta", as.character=TRUE)
beta_name = 'Betacoronavirus_less_amb_1ABSEMN_aln_1.0_0.9ng — копия.fasta'
beta = read.dna(paste(path_al, 'beta/', beta_name, sep=""), format="fasta", as.character=TRUE)
#beta_rmse1000 = plot_rmse(beta, 100, 1000,"pdist","pairwise")
beta_rmse800 = plot_rmse(beta, 100, 800,"pdist","pairwise")
heatmap.2(as.matrix(beta_rmse800[nrow(beta_rmse800):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="beta, rmse (window=800,step=100)",tracecol=NA)
library(recDplot)
#beta_rmse1000 = plot_rmse(beta, 100, 1000,"pdist","pairwise")
beta_rmse800 = plot_rmse(beta, 100, 800,"pdist","pairwise")
library(recDplot)
library("recDplot")
library(ggplot2)
library(reticulate)
library("ape")
library("seqinr")
library(sjstats)
library("spider")
library("gridExtra")
#library(hexbin)
library(grid)
library(gplots)
library(colorRamps)
#path_figure = "D:/Users/User/Google Диск/Coronaviruses/paper/figures/"
path_figure = "C:/Users/alxva/Google Диск/Coronaviruses/paper/figures2/"
library("recDplot")
library(ggplot2)
library(reticulate)
library("ape")
library("seqinr")
library(sjstats)
library("spider")
library("gridExtra")
#library(hexbin)
library(grid)
library(gplots)
library(colorRamps)
#path_figure = "D:/Users/User/Google Диск/Coronaviruses/paper/figures/"
path_figure = "C:/Users/alxva/Google Диск/Coronaviruses/paper/figures2/"
beta_name = 'Betacoronavirus_less_amb_1ABSEMN_aln_1.0_0.9ng — копия.fasta'
beta = read.dna(paste(path_al, 'beta/', beta_name, sep=""), format="fasta", as.character=TRUE)
#path_al = "D:/Users/User/Google Диск/Coronaviruses/gb/"
path_al = "C:/Users/alxva/Google Диск/Coronaviruses/gb/"
beta = read.dna(paste(path_al, 'beta/', beta_name, sep=""), format="fasta", as.character=TRUE)
beta[beta=='-'] <- NA
beta_rmse800 = plot_rmse(beta, 100, 800,"pdist","pairwise")
heatmap.2(as.matrix(beta_rmse800[nrow(beta_rmse800):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="beta, rmse (window=800,step=100)",tracecol=NA)
svg(file=paste(path_figure, "Beta_rmse_800.svg", sep=""))
heatmap.2(as.matrix(beta_rmse800[nrow(beta_rmse800):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="beta, rmse (window=800,step=100)",tracecol=NA)
dev.off()
#path_figure = "D:/Users/User/Google Диск/Coronaviruses/paper/figures/"
path_figure = "C:/Users/alxva/Google Диск/Coronaviruses/paper/figures2/"
#path_al = "D:/Users/User/Google Диск/Coronaviruses/gb/"
path_al = "C:/Users/alxva/Google Диск/Coronaviruses/gb/"
alpha_name = 'Alphacoronavirus_less_amb_1ABSEMN_aln_1.0_0.9ng — копия.fasta'
alpha = read.dna(paste(path_al, 'alpha/', alpha_name, sep=""), format="fasta", as.character=TRUE)
alpha[alpha=='-'] <- NA
#alpha_rmse = plot_rmse(alpha, 50, 500,"pdist","pairwise")
alpha_rmse800 = plot_rmse(alpha, 100, 800,"pdist","pairwise")
#alpha_slope = plot_slope(alpha, 50, 400,"pdist","pairwise")
#svg(file=paste(path_figure, "Alpha_rmse.svg", sep=""))
#heatmap.2(as.matrix(alpha_rmse[nrow(alpha_rmse):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="Alpha, rmse (window=500,step=50)",tracecol=NA)
#dev.off()
svg(file=paste(path_figure, "Alpha_rmse_800.svg", sep=""))
heatmap.2(as.matrix(alpha_rmse800[nrow(alpha_rmse800):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="Alpha, rmse (window=800,step=100)",tracecol=NA)
dev.off()
heatmap.2(as.matrix(alpha_rmse[nrow(alpha_rmse):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="Alpha, rmse (window=500,step=50)",tracecol=NA)
heatmap.2(as.matrix(alpha_rmse[nrow(alpha_rmse800):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="Alpha, rmse (window=500,step=50)",tracecol=NA)
heatmap.2(as.matrix(alpha_rmse800[nrow(alpha_rmse800):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="Alpha, rmse (window=500,step=50)",tracecol=NA)
#path_al = "D:/Users/User/Google Диск/Coronaviruses/gb/"
alpha_name_s = 'Alphacoronavirus_less_amb_S_aln_1.0_0.9ng — копия.fasta'
alpha_s = read.dna(paste(path_al, 'alpha/', alpha_name_s, sep=""), format="fasta", as.character=TRUE)
#path_al = "D:/Users/User/Google Диск/Coronaviruses/gb/"
alpha_name_s = 'Alphacoronavirus_less_amb_S_aln_1.0_0.9ng - копия.fasta'
alpha_s = read.dna(paste(path_al, 'alpha/', alpha_name_s, sep=""), format="fasta", as.character=TRUE)
alpha_s[alpha_s=='-'] <- NA
alpha_rmse_s = plot_rmse(alpha_s, 10, 100,"pdist","pairwise")
svg(file=paste(path_figure, "Alpha_rmse_S.svg", sep=""))
heatmap.2(as.matrix(alpha_rmse_s[nrow(alpha_rmse_s):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="Alpha, rmse (window=100,step=10)",tracecol=NA)
dev.off()
heatmap.2(as.matrix(alpha_rmse_s[nrow(alpha_rmse_s):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="Alpha, rmse (window=100,step=10)",tracecol=NA)
beta_name = 'Betacoronavirus_less_amb_1ABSEMN_aln_1.0_0.9ng — копия.fasta'
beta = read.dna(paste(path_al, 'beta/', beta_name, sep=""), format="fasta", as.character=TRUE)
beta[beta=='-'] <- NA
#beta_rmse = plot_rmse(beta, 50, 500,"pdist","pairwise")
#beta_rmse1000 = plot_rmse(beta, 100, 1000,"pdist","pairwise")
beta_rmse800 = plot_rmse(beta, 100, 800,"pdist","pairwise")
#beta_slope = plot_slope(beta, 50, 400,"pdist","pairwise")
#heatmap.2(as.matrix(beta_rmse[nrow(beta_rmse):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="beta, rmse (window=500,step=50)",tracecol=NA)
heatmap.2(as.matrix(beta_rmse800[nrow(beta_rmse800):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="beta, rmse (window=800,step=100)",tracecol=NA)
#heatmap.2(as.matrix(beta_rmse1000[nrow(beta_rmse1000):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="beta, rmse (window=1000,step=100)",tracecol=NA)
#pdf(file=paste(path_figure, "Beta_rmse.pdf", sep=""))
#heatmap.2(as.matrix(beta_rmse[nrow(beta_rmse):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="beta, rmse (window=500,step=50)",tracecol=NA)
#dev.off()
#svg(file=paste(path_figure, "Beta_rmse.svg", sep=""))
#heatmap.2(as.matrix(beta_rmse[nrow(beta_rmse):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="beta, rmse (window=500,step=50)",tracecol=NA)
#dev.off()
#svg(file=paste(path_figure, "Beta_rmse_1000.svg", sep=""))
#heatmap.2(as.matrix(beta_rmse1000[nrow(beta_rmse1000):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="beta, rmse (window=1000,step=100)",tracecol=NA)
#dev.off()
svg(file=paste(path_figure, "Beta_rmse_800-1.svg", sep=""))
heatmap.2(as.matrix(beta_rmse800[nrow(beta_rmse800):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="beta, rmse (window=800,step=100)",tracecol=NA)
dev.off()
heatmap.2(as.matrix(beta_rmse800[nrow(beta_rmse800):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="beta, rmse (window=500,step=50)",tracecol=NA)
#heatmap.2(as.matrix(beta_slope[nrow(beta_slope):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="beta, slope (window=400,step=50)",tracecol=NA)
contr = plot_control(beta)
contr_beta = contr[[1]]
ggsave(file=paste(path_figure, "control_beta.svg", sep=""), plot=contr_beta, width=10, height=8)
ggsave(file=paste(path_figure, "control_beta.png", sep=""), plot=contr_beta, width=10, height=8)
ggsave(file=paste(path_figure, "control_beta.pdf", sep=""), plot=contr_beta, width=10, height=8)
contr_beta
beta_name_s = 'Betacoronavirus_less_amb_S_aln_1.0_0.9ng — копия.fasta'
beta_s = read.dna(paste(path_al, 'beta/', beta_name_s, sep=""), format="fasta", as.character=TRUE)
beta_s[beta_s=='-'] <- NA
beta_rmse_s = plot_rmse(beta_s, 10, 100,"pdist","pairwise")
svg(file=paste(path_figure, "Beta_rmse_S.svg", sep=""))
heatmap.2(as.matrix(beta_rmse_s[nrow(beta_rmse_s):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="Beta, rmse (window=100,step=10)",tracecol=NA)
dev.off()
heatmap.2(as.matrix(beta_rmse_s[nrow(beta_rmse_s):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="Beta, rmse (window=100,step=10)",tracecol=NA)
gamma_name = 'Gammacoronavirus_less_amb_1ABSEMN_aln_1.0_0.9ng — копия.fasta'
gamma = read.dna(paste(path_al, 'gamma/', gamma_name, sep=""), format="fasta", as.character=TRUE)
gamma[gamma=='-'] <- NA
#gamma_rmse = plot_rmse(gamma, 50, 500,"pdist","pairwise")
gamma_rmse_800 = plot_rmse(gamma, 100, 800,"pdist","pairwise")
#gamma_slope = plot_slope(gamma, 50, 400,"pdist","pairwise")
contr = plot_control(gamma)
contr_gamma = contr[[1]]
#ggsave(file=paste(path_figure, "control_gamma.svg", sep=""), plot=contr_gamma, width=10, height=8)
#ggsave(file=paste(path_figure, "control_gamma.png", sep=""), plot=contr_gamma, width=10, height=8)
#ggsave(file=paste(path_figure, "control_gamma.pdf", sep=""), plot=contr_gamma, width=10, height=8)
contr_gamma
#pdf(file=paste(path_figure, "Gamma_rmse.pdf", sep=""))
#heatmap.2(as.matrix(gamma_rmse[nrow(gamma_rmse):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="gamma, rmse (window=400,step=50)",tracecol=NA)
#dev.off()
#svg(file=paste(path_figure, "Gamma_rmse.svg", sep=""))
#heatmap.2(as.matrix(gamma_rmse[nrow(gamma_rmse):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="gamma, rmse (window=400,step=50)",tracecol=NA)
#dev.off()
svg(file=paste(path_figure, "Gamma_rmse_800-1.svg", sep=""))
heatmap.2(as.matrix(gamma_rmse_800[nrow(gamma_rmse_800):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="gamma, rmse (window=800,step=100)",tracecol=NA)
dev.off()
heatmap.2(as.matrix(gamma_rmse_800[nrow(gamma_rmse_800):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="gamma, rmse (window=500,step=50)",tracecol=NA)
#heatmap.2(as.matrix(gamma_slope[nrow(gamma_slope):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="gamma, slope (window=400,step=50)",tracecol=NA)
gamma_name_s = 'Betacoronavirus_less_amb_S_aln_1.0_0.9ng — копия.fasta'
gamma_s = read.dna(paste(path_al, 'gamma/', beta_name_s, sep=""), format="fasta", as.character=TRUE)
gamma_name_s = 'Gammacoronavirus_less_amb_S_aln_1.0_0.9ng — копия.fasta'
gamma_s = read.dna(paste(path_al, 'gamma/', beta_name_s, sep=""), format="fasta", as.character=TRUE)
gamma_name_s = 'Gammacoronavirus_less_amb_S_aln_1.0_0.9ng — копия.fasta'
gamma_s = read.dna(paste(path_al, 'gamma/', gamma_name_s, sep=""), format="fasta", as.character=TRUE)
gamma_s[gamma_s=='-'] <- NA
gamma_rmse_s = plot_rmse(gamma_s, 10, 100,"pdist","pairwise")
svg(file=paste(path_figure, "Gamma_rmse_S.svg", sep=""))
heatmap.2(as.matrix(gamma_rmse_s[nrow(gamma_rmse_s):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="Gamma, rmse (window=100,step=10)",tracecol=NA)
dev.off()
heatmap.2(as.matrix(gamma_rmse_s[nrow(gamma_rmse_s):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="Beta, rmse (window=100,step=10)",tracecol=NA)
heatmap.2(as.matrix(gamma_rmse_s[nrow(gamma_rmse_s):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="Gamma, rmse (window=100,step=10)",tracecol=NA)
gamma_name_s = 'Gammacoronavirus_less_amb_S_aln_1.0_0.9ng — копия.fasta'
gamma_s = read.dna(paste(path_al, 'gamma/', gamma_name_s, sep=""), format="fasta", as.character=TRUE)
gamma_s[gamma_s=='-'] <- NA
gamma_rmse_s = plot_rmse(gamma_s, 20, 100,"pdist","pairwise")
svg(file=paste(path_figure, "Gamma_rmse_S.svg", sep=""))
heatmap.2(as.matrix(gamma_rmse_s[nrow(gamma_rmse_s):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="Gamma, rmse (window=100,step=10)",tracecol=NA)
dev.off()
beta_name_s = 'Betacoronavirus_less_amb_S_aln_1.0_0.9ng — копия.fasta'
beta_s = read.dna(paste(path_al, 'beta/', beta_name_s, sep=""), format="fasta", as.character=TRUE)
beta_s[beta_s=='-'] <- NA
beta_rmse_s = plot_rmse(beta_s, 20, 100,"pdist","pairwise")
svg(file=paste(path_figure, "Beta_rmse_S.svg", sep=""))
heatmap.2(as.matrix(beta_rmse_s[nrow(beta_rmse_s):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="Beta, rmse (window=100,step=10)",tracecol=NA)
dev.off()
#path_al = "D:/Users/User/Google Диск/Coronaviruses/gb/"
alpha_name_s = 'Alphacoronavirus_less_amb_S_aln_1.0_0.9ng - копия.fasta'
alpha_s = read.dna(paste(path_al, 'alpha/', alpha_name_s, sep=""), format="fasta", as.character=TRUE)
alpha_s[alpha_s=='-'] <- NA
alpha_rmse_s = plot_rmse(alpha_s, 20, 100,"pdist","pairwise")
svg(file=paste(path_figure, "Alpha_rmse_S.svg", sep=""))
heatmap.2(as.matrix(alpha_rmse_s[nrow(alpha_rmse_s):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="Alpha, rmse (window=100,step=20)",tracecol=NA)
dev.off()
#path_al = "D:/Users/User/Google Диск/Coronaviruses/gb/"
alpha_name_ab = 'Alphacoronavirus_less_amb_1AB_aln_1.0_0.9ng - копия.fasta'
alpha_ab = read.dna(paste(path_al, 'alpha/', alpha_name_ab, sep=""), format="fasta", as.character=TRUE)
#path_al = "D:/Users/User/Google Диск/Coronaviruses/gb/"
alpha_name_ab = 'Alphacoronavirus_less_amb_1AB_aln_1.0_0.9ng — копия.fasta'
alpha_ab = read.dna(paste(path_al, 'alpha/', alpha_name_ab, sep=""), format="fasta", as.character=TRUE)
alpha_ab[alpha_ab=='-'] <- NA
alpha_rmse_ab = plot_rmse(alpha_ab, 100, 800,"pdist","pairwise")
svg(file=paste(path_figure, "Alpha_rmse_1AB.svg", sep=""))
heatmap.2(as.matrix(alpha_rmse_s[nrow(alpha_rmse_ab):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="Alpha, rmse (window=800,step=100)",tracecol=NA)
dev.off()
heatmap.2(as.matrix(alpha_rmse_s[nrow(alpha_rmse_ab):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="Alpha, rmse (window=800,step=100)",tracecol=NA)
svg(file=paste(path_figure, "Alpha_rmse_1AB.svg", sep=""))
heatmap.2(as.matrix(alpha_rmse_ab[nrow(alpha_rmse_ab):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="Alpha, rmse (window=800,step=100)",tracecol=NA)
dev.off()
svg(file=paste(path_figure, "Alpha_rmse_1AB.svg", sep=""))
heatmap.2(as.matrix(alpha_rmse_ab[nrow(alpha_rmse_ab):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="Alpha, rmse (window=800,step=100)",tracecol=NA)
dev.off()
heatmap.2(as.matrix(alpha_rmse_ab[nrow(alpha_rmse_ab):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="Alpha, rmse (window=800,step=100)",tracecol=NA)
beta_name_ab = 'Betacoronavirus_less_amb_1AB_aln_1.0_0.9ng — копия.fasta'
beta_ab = read.dna(paste(path_al, 'beta/', beta_name_ab, sep=""), format="fasta", as.character=TRUE)
beta_ab[beta_ab=='-'] <- NA
beta_rmse_ab = plot_rmse(beta_ab, 20, 100,"pdist","pairwise")
svg(file=paste(path_figure, "Beta_rmse_ab.svg", sep=""))
heatmap.2(as.matrix(beta_rmse_ab[nrow(beta_rmse_ab):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="Beta 1ab, rmse (window=800,step=100)",tracecol=NA)
dev.off()
heatmap.2(as.matrix(beta_rmse_ab[nrow(beta_rmse_ab):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="Beta 1ab, rmse (window=800,step=100)",tracecol=NA)
beta_name_ab = 'Betacoronavirus_less_amb_1AB_aln_1.0_0.9ng — копия.fasta'
beta_name_ab = 'Betacoronavirus_less_amb_1AB_aln_1.0_0.9ng — копия.fasta'
beta_ab = read.dna(paste(path_al, 'beta/', beta_name_ab, sep=""), format="fasta", as.character=TRUE)
beta_ab[beta_ab=='-'] <- NA
beta_rmse_ab = plot_rmse(beta_ab, 100, 800,"pdist","pairwise")
svg(file=paste(path_figure, "Beta_rmse_ab.svg", sep=""))
heatmap.2(as.matrix(beta_rmse_ab[nrow(beta_rmse_ab):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="Beta 1ab, rmse (window=800,step=100)",tracecol=NA)
dev.off()
heatmap.2(as.matrix(beta_rmse_s[nrow(beta_rmse_s):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="Beta, rmse (window=100,step=10)",tracecol=NA)
heatmap.2(as.matrix(beta_rmse_ab[nrow(beta_rmse_ab):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="Beta 1ab, rmse (window=800,step=100)",tracecol=NA)
gamma_name_ab = 'Gammacoronavirus_less_amb_1AB_aln_1.0_0.9ng — копия.fasta'
gamma_ab = read.dna(paste(path_al, 'gamma/', gamma_name_ab, sep=""), format="fasta", as.character=TRUE)
gamma_ab[gamma_ab=='-'] <- NA
gamma_rmse_ab = plot_rmse(gamma_ab, 100, 800,"pdist","pairwise")
svg(file=paste(path_figure, "Gamma_rmse_ab.svg", sep=""))
heatmap.2(as.matrix(gamma_rmse_ab[nrow(gamma_rmse_ab):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="Gamma 1ab, rmse (window=800,step=100)",tracecol=NA)
dev.off()
library("recDplot")
library(ggplot2)
library(reticulate)
library("ape")
library("seqinr")
library(sjstats)
library("spider")
library("gridExtra")
#library(hexbin)
library(grid)
library(gplots)
library(colorRamps)
library("recDplot")
library(ggplot2)
library(reticulate)
library("ape")
library("seqinr")
library(sjstats)
library("spider")
library("gridExtra")
#library(hexbin)
library(grid)
library(gplots)
library(colorRamps)
#path_figure = "D:/Users/User/Google Диск/Coronaviruses/paper/figures/"
path_figure = "C:/Users/alxva/Google Диск/Coronaviruses/paper/figures2/"
#path_al = "D:/Users/User/Google Диск/Coronaviruses/gb/"
path_al = "C:/Users/alxva/Google Диск/Coronaviruses/gb/"
sars_name = '020420_gisaid_cov2020_sequences_5res_aln_0.01_noUTR.fasta'
sars = read.dna(paste(path_al, 'sars-2/', sars_name, sep=""), format="fasta", as.character=TRUE)
sars[sars=='-'] <- NA
#beta_rmse1000 = plot_rmse(beta, 100, 1000,"pdist","pairwise")
sars_rmse = plot_rmse(sars, 100, 1000,"pdist","pairwise")
svg(file=paste(path_figure, "sars2_rmse.svg", sep=""))
heatmap.2(as.matrix(sars_rmse[nrow(sars_rmse):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="SARS-2, rmse (window=1000,step=100)",tracecol=NA)
dev.off()
heatmap.2(as.matrix(sars_rmse[nrow(sars_rmse):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="SARS-2, rmse (window=1000,step=100)",tracecol=NA)
sars_name = '020420_gisaid_cov2020_sequences_1res_aln_0.01_noUTR.fasta'
sars = read.dna(paste(path_al, 'sars-2/', sars_name, sep=""), format="fasta", as.character=TRUE)
sars_name = '020420_gisaid_cov2020_sequences_1res_aln_0.01_noUTR.fasta'
sars = read.dna(paste(path_al, 'sars-2/', sars_name, sep=""), format="fasta", as.character=TRUE)
sars[sars=='-'] <- NA
#beta_rmse1000 = plot_rmse(beta, 100, 1000,"pdist","pairwise")
sars_rmse = plot_rmse(sars, 100, 1000,"pdist","pairwise")
svg(file=paste(path_figure, "sars2_1n_rmse.svg", sep=""))
heatmap.2(as.matrix(sars_rmse[nrow(sars_rmse):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="SARS-2,rmse(window=1000,step=100)",tracecol=NA)
dev.off()
heatmap.2(as.matrix(sars_rmse[nrow(sars_rmse):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="SARS-2, rmse (window=1000,step=100)",tracecol=NA)
sars_name = '020420_gisaid_cov2020_sequences_5res_aln_0.0001_noUTR.fasta'
sars = read.dna(paste(path_al, 'sars-2/', sars_name, sep=""), format="fasta", as.character=TRUE)
sars = read.dna(paste(path_al, 'sars-2/', sars_name, sep=""), format="fasta", as.character=TRUE)
sars[sars=='-'] <- NA
#beta_rmse1000 = plot_rmse(beta, 100, 1000,"pdist","pairwise")
sars_rmse = plot_rmse(sars, 100, 1000,"pdist","pairwise")
svg(file=paste(path_figure, "sars2_5n_0.001_rmse.svg", sep=""))
heatmap.2(as.matrix(sars_rmse[nrow(sars_rmse):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="SARS-2,rmse(window=1000,step=100)",tracecol=NA)
dev.off()
sars_name_s = '020420_gisaid_cov2020_sequences_1res_aln_0.01_S.fasta'
sars_s = read.dna(paste(path_al, 'sars-2/', sars_name, sep=""), format="fasta", as.character=TRUE)
sars_s[sars_s=='-'] <- NA
sars_name = '020420_gisaid_cov2020_sequences_1res_aln_0.01_noUTR_onlyhumans.fasta'
sars = read.dna(paste(path_al, 'sars-2/', sars_name, sep=""), format="fasta", as.character=TRUE)
#path_figure = "D:/Users/User/Google Диск/Coronaviruses/paper/figures/"
path_figure = "D:/Virology/Coronaviruses/paper/figures2/"
#path_al = "D:/Users/User/Google Диск/Coronaviruses/gb/"
path_al = "D:/Virology/Coronaviruses/gb/"
sars_name = '020420_gisaid_cov2020_sequences_1res_aln_0.01_noUTR_onlyhumans.fasta'
sars = read.dna(paste(path_al, 'sars-2/', sars_name, sep=""), format="fasta", as.character=TRUE)
sars[sars=='-'] <- NA
#beta_rmse1000 = plot_rmse(beta, 100, 1000,"pdist","pairwise")
sars_rmse = plot_rmse(sars, 100, 1000,"pdist","pairwise")
svg(file=paste(path_figure, "sars2_5n_0.001_rmse.svg", sep=""))
heatmap.2(as.matrix(sars_rmse[nrow(sars_rmse):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="SARS-2,rmse(window=1000,step=100)",tracecol=NA)
dev.off()
heatmap.2(as.matrix(sars_rmse[nrow(sars_rmse):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="SARS-2, rmse (window=1000,step=100)",tracecol=NA)
svg(file=paste(path_figure, "sars2_1n_0.01_rmse_onlyhuman.svg", sep=""))
heatmap.2(as.matrix(sars_rmse[nrow(sars_rmse):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="SARS-2,rmse(window=1000,step=100)",tracecol=NA)
heatmap.2(as.matrix(sars_rmse[nrow(sars_rmse):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="SARS-2,rmse(window=1000,step=100)",tracecol=NA)
dev.off()
l = plot_dist_test(beta, 6000,7000,17000,18000)
l[[1]] + stat_bin2d(binwidth = 0.00001)
l = plot_dist_test(sars, 6000,7000,17000,18000)
l[[1]] + stat_bin2d(binwidth = 0.00001)
l = plot_dist_test(sars, 6000,7000,17000,18000)
l[[1]] + stat_bin2d(binwidth = 0.01)
l[[1]] + stat_bin2d(binwidth = 0.001)
l[[1]] + stat_bin2d(binwidth = 0.0001)
library("recDplot")
library(ggplot2)
library(reticulate)
library("ape")
library("seqinr")
library(sjstats)
library("spider")
library("gridExtra")
#library(hexbin)
library(grid)
library(gplots)
library(colorRamps)
library(recDplot)
library("recDplot")
library(ggplot2)
library(reticulate)
library("ape")
library("seqinr")
library(sjstats)
library("spider")
library("gridExtra")
#library(hexbin)
library(grid)
library(gplots)
library(colorRamps)
library("recDplot")
library(ggplot2)
library(reticulate)
library("ape")
library("seqinr")
library(sjstats)
library("spider")
library("gridExtra")
#library(hexbin)
library(grid)
library(gplots)
library(colorRamps)
library("recDplot")
library(ggplot2)
library(reticulate)
library("ape")
library("seqinr")
library(sjstats)
library("spider")
library("gridExtra")
#library(hexbin)
library(grid)
library(gplots)
library(colorRamps)
sars_name = '110420_gisaid_cov2020_sequences_res_aln_1e-05_noUTR.fasta'
sars = read.dna(paste(path_al, 'sars-2/', sars_name, sep=""), format="fasta", as.character=TRUE)
#path_figure = "D:/Users/User/Google Диск/Coronaviruses/paper/figures/"
path_figure = "D:/Virology/Coronaviruses/paper/figures2/"
path_al = "D:/Virology/Coronaviruses/gb/"
sars_name = '110420_gisaid_cov2020_sequences_res_aln_1e-05_noUTR.fasta'
sars = read.dna(paste(path_al, 'sars-2/', sars_name, sep=""), format="fasta", as.character=TRUE)
sars[sars=='-'] <- NA
contr = plot_control(sars)
contr = plot_control(sars)
contr_sars = contr[[1]]
contr_sars # + stat_bin2d()
ggsave(file=paste(path_figure, "control_sars1e-5gaps.svg", sep=""), plot=contr_beta, width=10, height=8)
ggsave(file=paste(path_figure, "control_sars1e-5gaps.svg", sep=""), plot=contr_sars, width=10, height=8)
sars_test = plot_dist_test(sars, 3000, 4000, 13500, 14500)
sars_test = plot_dist_test(sars, 3000, 4000, 13500, 14500)
plot_sars = sars_test[[1]]
plot_sars # + stat_bin2d()
ggsave(file=paste(path_figure, "distplt_sars1e-5gaps_3000-4000_13500-14500.svg", sep=""), plot=plot_sars, width=10, height=8)
plot_sars
sars_name = '110420_gisaid_cov2020_sequences_res_aln_1e-05_noUTR_human.fasta'
sars = read.dna(paste(path_al, 'sars-2/', sars_name, sep=""), format="fasta", as.character=TRUE)
sars[sars=='-'] <- NA
sars = read.dna(paste(path_al, 'sars-2/', sars_name, sep=""), format="fasta", as.character=TRUE)
sars_name = '110420_gisaid_cov2020_sequences_res_aln_1e-05_noUTR_human.fasta'
sars = read.dna(paste(path_al, 'sars-2/', sars_name, sep=""), format="fasta", as.character=TRUE)
sars = read.dna(paste(path_al, 'sars-2/', sars_name, sep=""), format="fasta", as.character=TRUE)
sars[sars=='-'] <- NA
sars_rmse = plot_rmse(sars, 100, 1000,"pdist","pairwise")
sars_rmse = plot_rmse(sars, 100, 1000,"pdist","pairwise")
svg(file=paste(path_figure, "sars2_rmse_human.svg", sep=""))
heatmap.2(as.matrix(sars_rmse[nrow(sars_rmse):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="SARS-2, rmse (window=1000,step=100)",tracecol=NA)
dev.off()
heatmap.2(as.matrix(sars_rmse[nrow(sars_rmse):1,]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="SARS-2, rmse (window=1000,step=100)",tracecol=NA)
contr = plot_control(sars)
contr_sars = contr[[1]]
contr_sars # + stat_bin2d()
ggsave(file=paste(path_figure, "control_sars1e-5gaps_human.svg", sep=""), plot=contr_sars, width=10, height=8)
contr_sars  + stat_bin2d(bins=30)
contr_sars  + stat_bin2d()
contr_sars  + stat_bin2d(bins=50)
ggplot(data.frame(contr[[2]],contr[[3]]),aes(contr[[2]],contr[[3]]))
contr[[2]]
ggplot(data.frame(as.vector(contr[[2]]),as.vector(contr[[3]])),aes(as.vector(contr[[2]]),as.vector(contr[[3]])))
ggplot(data.frame(as.vector(contr[[2]]),as.vector(contr[[3]])),aes(as.vector(contr[[2]]),as.vector(contr[[3]]))) + stat_bin2d(binwidth = 0.003)
ggplot(data.frame(as.vector(contr[[2]]),as.vector(contr[[3]])),aes(as.vector(contr[[2]]),as.vector(contr[[3]]))) + stat_bin2d(binwidth)
ggplot(data.frame(as.vector(contr[[2]]),as.vector(contr[[3]])),aes(as.vector(contr[[2]]),as.vector(contr[[3]]))) + stat_bin2d()
contr = plot_control(sars)
contr = plot_control(sars)
contr_sars = contr[[1]]
contr_sars
ggsave(file=paste(path_figure, "control_sars1e-5gaps_human.svg", sep=""), plot=contr_sars, width=10, height=8)
contr_sars
contr_sars + stat_bin2d()
ggsave(file=paste(path_figure, "control_sars1e-5gaps_human.svg", sep=""), plot=contr_sars + stat_bin2d(), width=10, height=8)
sars_test = plot_dist_test(sars, 1, 1000, 16501, 17500)
sars_test = plot_dist_test(sars, 1, 1000, 16501, 17500)
plot_sars = sars_test[[1]]
plot_sars
sars_test = plot_dist_test(sars, 1, 1000, 16501, 17500)
sars_test = plot_dist_test(sars, 1, 1000, 16501, 17500)
plot_sars = sars_test[[1]]
plot_sars
ggsave(file=paste(path_figure, "distplt_sars1e-5gaps_1-1000_16501-17500.svg", sep=""), plot=plot_sars, width=10, height=8)
plot_sars
sars_test = plot_dist_test(sars, 5501, 6500, 27701, 28700)
plot_sars = sars_test[[1]]
ggsave(file=paste(path_figure, "distplt_sars1e-5gaps_5501-6500_27701-28700.svg", sep=""), plot=plot_sars, width=10, height=8)
plot_sars
ggsave(file=paste(path_figure, "distplt_sars1e-5gaps_5501-6500_27701-28700.svg", sep=""), plot=plot_sars, width=10, height=8)
plot_sars
