rownames(rdp_df)=starts
heatmap.2(as.matrix(rf_matrix[(nrow(rf_matrix)-1):1,1:(nrow(rf_matrix)-1)]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="beta, RDP",tracecol=NA)
starts = seq(from=0, to=length_aln, by = step) # start positions of genomic regions
starts[1]=1
ends = seq(from=window, to = length_aln, by = step) # end positions of genomic regions
if (length_aln%%step>step){ends=c(ends,length_aln)}
#dataframe to store RMSE values of each comparison
rdp_df = data.frame(as.matrix(rf_matrix, ncol=length(starts), nrow = length(starts)))
colnames(rdp_df)=starts
rownames(rdp_df)=starts
heatmap.2(as.matrix(rf_matrix[(nrow(rf_matrix)-1):1,1:(nrow(rf_matrix)-1)]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="beta, RDP",tracecol=NA)
heatmap.2(rdp_df(rdp_df[nrow(rdp_df):1,1:nrow(rdp_df)]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="beta, RDP",tracecol=NA)
heatmap.2(rdp_df(rdp_df[(nrow(rdp_df)-1):1,1:(nrow(rdp_df)-1)]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="beta, RDP",tracecol=NA)
heatmap.2(as.matrix(rdp_df[(nrow(rdp_df)-1):1,1:(nrow(rdp_df)-1)]),Rowv = FALSE, Colv = "Rowv", dendrogram = 'none',col=matlab.like, main="beta, RDP",tracecol=NA)
l = plot_dist_test(delta,18532,21915,22165,22818)
l[[1]]
ggsave(file=paste(fig_path, "delta_SvsM.svg", sep=""), plot=l[[1]], width=10, height=8)
l = plot_dist_test(beta, 1,19398,19399,22746)
l = plot_dist_test(beta, 1,19398,19399,22746)
l[[1]]
ggsave(file=paste(fig_path, "betaN_1ABvsS.svg", sep=""), plot=l[[1]], width=10, height=8)
l = plot_dist_test(beta,19399,22746,22972,23628)
l[[1]]
ggsave(file=paste(fig_path, "betaN_SvsM.svg", sep=""), plot=l[[1]], width=10, height=8)
l = plot_dist_test(beta,19399,22746,23695,24759)
l = plot_dist_test(beta,19399,22746,23629,24690)
l[[1]]
ggsave(file=paste(fig_path, "betaN_SvsN.svg", sep=""), plot=l[[1]], width=10, height=8)
l = plot_dist_test(beta,19399,22746,22747,22971)
l[[1]]
ggsave(file=paste(fig_path, "betaN_SvsE.svg", sep=""), plot=l[[1]], width=10, height=8)
l = plot_dist_test(beta,23629,24690,22747,22971)
l[[1]]
ggsave(file=paste(fig_path, "betaN_NvsE.svg", sep=""), plot=l[[1]], width=10, height=8)
l = plot_dist_test(beta,22972,23628,22747,22971)
l[[1]]
ggsave(file=paste(fig_path, "betaN_MvsE.svg", sep=""), plot=l[[1]], width=10, height=8)
l = plot_dist_test(beta,22972,23628,23629,24690)
l[[1]]
ggsave(file=paste(fig_path, "betaN_MvsN.svg", sep=""), plot=l[[1]], width=10, height=8)
l = plot_dist_test(delta, 1,10608,10609,18531)
l[[1]]
ggsave(file=paste(fig_path, "delta_1Avs1B.svg", sep=""), plot=l[[1]], width=10, height=8)
l
lm(l[[2]]~l[[3]])
rmse(lm(l[[2]]~l[[3]]))
dist_plot=ggplot(data.frame(l[[2]],l[[3]]),aes(l[[2]],l[[3]]))+stat_bin2d(binwidth = 0.003)+
scale_fill_gradientn(colours=c("blue","red"))+ theme(legend.justification=c(1,0), legend.position=c(1,0))+
xlab(paste(toString(st1),toString(e1),sep=":"))+ylab(paste(toString(st2),toString(e2),sep=":"))
dist1= as.vector(l[[2]]) + rnorm(length(l[[2]]),mean = 0,sd= 0.001)
dist2= as.vector(l[[3]]) + rnorm(length(l[[3]]),mean = 0,sd= 0.001)
+  geom_smooth(method='lm',formula=y~x)
dist_plot=ggplot(data.frame(dist1,dist2),aes(dist1,dist2))+stat_bin2d(binwidth = 0.003)+
scale_fill_gradientn(colours=c("blue","red"))+ theme(legend.justification=c(1,0), legend.position=c(1,0))+
xlab(paste(toString(st1),toString(e1),sep=":"))+ylab(paste(toString(st2),toString(e2),sep=":"))
dist_plot=ggplot(data.frame(dist1,dist2),aes(dist1,dist2))+stat_bin2d(binwidth = 0.003)+
scale_fill_gradientn(colours=c("blue","red"))+ theme(legend.justification=c(1,0), legend.position=c(1,0))+
xlab("region 1")+ylab("region 2")
dist_plot
dist_plot=ggplot(data.frame(dist1,dist2),aes(dist1,dist2))+stat_bin2d(binwidth = 0.003)+
scale_fill_gradientn(colours=c("blue","red"))+ theme(legend.justification=c(1,0), legend.position=c(1,0))+
xlab("region 1")+ylab("region 2")  +  geom_smooth(method='lm',formula=y~x)
dist_plot
dist_plot=ggplot(data.frame(dist1,dist2),aes(dist1,dist2))+stat_bin2d(binwidth = 0.003)+
scale_fill_gradientn(colours=c("blue","red"))+ theme(legend.justification=c(1,0), legend.position=c(1,0))+
xlab("region 1")+ylab("region 2")  +  geom_smooth(method='lm',formula=y~x, color="red")
dist_plot
rmse(lm(l[[2]]~l[[3]]))
dist_plot
ggsave(file=paste(fig_path, "distplot_lowrmse.svg", sep=""), plot=dist_plot, width=10, height=8)
i
l = plot_dist_test(delta,22819,23841,21916,22164)
l[[1]]
dist_plot
l = plot_dist_test(delta,22819,23841,21916,22164)
l[[1]]
ggsave(file=paste(fig_path, "delta_NvsE.svg", sep=""), plot=l[[1]], width=10, height=8)
dist1= as.vector(l[[2]]) + rnorm(length(l[[2]]),mean = 0,sd= 0.001)
dist2= as.vector(l[[3]]) + rnorm(length(l[[3]]),mean = 0,sd= 0.001)
dist_plot=ggplot(data.frame(dist1,dist2),aes(dist1,dist2))+stat_bin2d(binwidth = 0.003)+
scale_fill_gradientn(colours=c("blue","red"))+ theme(legend.justification=c(1,0), legend.position=c(1,0))+
xlab("region 1")+ylab("region 2")  +  geom_smooth(method='lm',formula=y~x, color="red")
dist_plot
dist_plot=ggplot(data.frame(dist1,dist2),aes(dist1,dist2))+stat_bin2d(binwidth = 0.003)+
scale_fill_gradientn(colours=c("blue","red"))+ theme(legend.justification=c(1,0), legend.position=c(1,0))+
xlab("region 1")+ylab("region 3")  +  geom_smooth(method='lm',formula=y~x, color="red")
dist_plot
ggsave(file=paste(fig_path, "distplot_highrmse.svg", sep=""), plot=dist_plot, width=10, height=8)
rmse(lm(l[[2]]~l[[3]]))
rmse(lm(l[[2]]~l[[3]]))
l = plot_dist_test(delta, 1,10608,10609,18531)
l[[1]]
ggsave(file=paste(fig_path, "delta_1Avs1B.svg", sep=""), plot=l[[1]], width=10, height=8)
l[[2]]
lm(l[[2]]~l[[3]])
rmse(lm(l[[2]]~l[[3]]))
dist1= as.vector(l[[2]]) + rnorm(length(l[[2]]),mean = 0,sd= 0.001)
dist2= as.vector(l[[3]]) + rnorm(length(l[[3]]),mean = 0,sd= 0.001)
dist_plot=ggplot(data.frame(dist1,dist2),aes(dist1,dist2))+stat_bin2d(binwidth = 0.003)+
scale_fill_gradientn(colours=c("blue","red"))+ theme(legend.justification=c(1,0), legend.position=c(1,0))+
xlab("region 1")+ylab("region 2")  +  geom_smooth(method='lm',formula=y~x, color="red")
dist_plot
ggsave(file=paste(fig_path, "distplot_lowrmse.svg", sep=""), plot=dist_plot, width=10, height=8)
l = plot_dist_test(delta, 18697,19338,19408,19791)
library("recDplot")
library(ggplot2)
library(reticulate)
library("ape")
library("seqinr")
library(sjstats)
library("spider")
library("gridExtra")
#library(hexbin)
library(grid)
library(gplots)
library(colorRamps)
l = plot_dist_test(delta, 18697,19338,19408,19791)
folder_new = 'D:/DATA/Virology/Coronaviruses/gb/new_datasets/'
delta_name = 'D-CoV_1ABSEMN_0.5_0.9ng.fasta'
delta = read.dna(paste(folder_new, 'delta/', delta_name, sep=""), format="fasta", as.character=TRUE)
delta[delta=='-'] <- NA
l = plot_dist_test(delta, 18697,19338,19408,19791)
l[[1]]
ggsave(file=paste(fig_path, "delta_NTDvsRBD.svg", sep=""), plot=l[[1]], width=10, height=8)
l = plot_dist_test(delta, 18697,19338,19408,19791)
l[[1]]
ggsave(file=paste(fig_path, "delta_NTDvsRBD.svg", sep=""), plot=l[[1]], width=10, height=8)
sapo = read.dna("D:/Users/User/Google Диск/Sapovirus_evolution_Artem/alignments/align_orfs_utrs_genotyped_gap20.fasta", format="fasta", as.character=TRUE)
dna_sl1=sapo[1:length(sapo[,1]), seq(from = 6766, to = 7292, by=1)]
View(dna_sl1)
# distance matrices for each region
dna_sl_dist1 <-dist.gene(dna_sl1, method = "percentage",  pairwise.deletion = TRUE)
dna_sl_dist1
dna_sl_dist1[1]
rownames(dna_sl_dist1)
as.matrix(dna_sl_dist1)
m = as.matrix(dna_sl_dist1)
View(m)
m[36]
rownames(m)
rownames(m)[36]
rownames(m)[185]
sapo[sapo=='-'] <- NA
sapo
View(sapo)
dna_sl1=sapo[1:length(sapo[,1]), seq(from = 1, to = 7292, by=1)]
# distance matrices for each region
dna_sl_dist1 <-dist.gene(dna_sl1, method = "percentage",  pairwise.deletion = TRUE)
m = as.matrix(dna_sl_dist1)
# distance matrices for each region
dna_sl_dist1 <-dist.gene(dna_sl1, method = "percentage",  pairwise.deletion = FALSE)
m = as.matrix(dna_sl_dist1)
library("recDplot")
library(ggplot2)
library(reticulate)
library("ape")
library("seqinr")
library(sjstats)
library("spider")
library("gridExtra")
#library(hexbin)
library(grid)
library(gplots)
library(colorRamps)
pdf.options(encoding = 'CP1250')
fig_path = "C:/Users/alxva/Google Диск/Coronaviruses/paper/figures2/"
fig_path = "D:/DATA/Virology/Coronaviruses/paper/figures2/"
path_al = "D:/DATA/Virology/Coronaviruses/gb/"
#path_al = "C:/Users/alxva/Google Диск/Coronaviruses/gb/"
alpha_name = 'Alphacoronavirus_less_amb_1ABSEMN_aln_1.0_0.9ng — копия.fasta'
alpha = read.dna(paste(path_al, 'alpha/', alpha_name, sep=""), format="fasta", as.character=TRUE)
alpha[alpha=='-'] <- NA
plot_control(alpha)[[1]]
#ORF1ab
plot_control(alpha[,1:19255])[[1]]
#ORF1ab and S
plot_control(cbind(alpha[,1:19255],alpha[,19256:22710]))[[1]]
#S
plot_control(alpha[,19256:22710])[[1]]
# NTD and CTD
plot_control(cbind(alpha[,19612:20190],alpha[,20272:20580]))[[1]]
# NTD and NTD
plot_control(alpha[,19612:20190])[[1]]
# CTD and CTD
plot_control(alpha[,20272:20580])[[1]]
# NTD and S2
plot_control(cbind(alpha[,19612:20190],alpha[,20872:22710]))[[1]]
# CTD and S2
plot_control(cbind(alpha[,20272:20580],alpha[,20872:22710]))[[1]]
# S2
plot_control(alpha[,20872:22710])[[1]]
# CTD and CTD
l = plot_control(alpha[,20272:20580])[[1]]+stat_bin2d(binwidth = 0.003)
ggsave(file=paste(fig_path, "Alpha_NTD_control.svg", sep=""), plot=l, width=10, height=8)
ggsave(file=paste(fig_path, "Alpha_NTD_control.svg", sep=""), plot=l, width=10, height=8)
l
#orf1AB VS s1
l =plot_dist_test(alpha,1,19255,19256,20871)[[1]]+stat_bin2d(binwidth = 0.003)
ggsave(file=paste(fig_path, "Alpha_ORF1abvsS1.svg", sep=""), plot=l, width=10, height=8)
l
#orf1AB VS s2
l = plot_dist_test(alpha,1,19255,20872,22710)[[1]]+stat_bin2d(binwidth = 0.003)
ggsave(file=paste(fig_path, "Alpha_ORF1abvsS2.svg", sep=""), plot=l, width=10, height=8)
l
#orf1AB VS NTD
l = plot_dist_test(alpha,1,19255,19612,20190)[[1]]+stat_bin2d(binwidth = 0.003)
ggsave(file=paste(fig_path, "Alpha_ORF1abvsNTD.svg", sep=""), plot=l, width=10, height=8)
l
#orf1AB VS CTD
l = plot_dist_test(alpha,1,19255,20272,20580)[[1]]+stat_bin2d(binwidth = 0.003)
ggsave(file=paste(fig_path, "Alpha_ORF1abvsCTD.svg", sep=""), plot=l, width=10, height=8)
l
folder_new = 'D:/DATA/Virology/Coronaviruses/gb/new_datasets/'
beta_name = 'Beta_1ABSEMN_1.0_0.9ng — копия.fasta'
beta = read.dna(paste(folder_new, 'beta/', beta_name, sep=""), format="fasta", as.character=TRUE)
beta[beta=='-'] <- NA
#orf1AB VS s1
l =plot_dist_test(beta,1,19398,19468,21060)[[1]]+stat_bin2d(binwidth = 0.003)
ggsave(file=paste(fig_path, "beta_ORF1abvsS1.svg", sep=""), plot=l, width=10, height=8)
l
#orf1AB VS s2
l = plot_dist_test(beta,1,19398,21061,22743)[[1]]+stat_bin2d(binwidth = 0.003)
ggsave(file=paste(fig_path, "beta_ORF1abvsS2.svg", sep=""), plot=l, width=10, height=8)
l
#orf1AB VS NTD
l = plot_dist_test(beta,1,19398,19429,20142)[[1]]+stat_bin2d(binwidth = 0.003)
ggsave(file=paste(fig_path, "beta_ORF1abvsNTD.svg", sep=""), plot=l, width=10, height=8)
l
#orf1AB VS CTD
l = plot_dist_test(beta,1,19398,20212,20646)[[1]]+stat_bin2d(binwidth = 0.003)
ggsave(file=paste(fig_path, "beta_ORF1abvsCTD.svg", sep=""), plot=l, width=10, height=8)
l
#orf1AB VS s1
l =plot_dist_test(gamma,1,19713,19714,21276)[[1]]+stat_bin2d(binwidth = 0.003)
ggsave(file=paste(fig_path, "gamma_ORF1abvsS1.svg", sep=""), plot=l, width=10, height=8)
l
#orf1AB VS s2
l = plot_dist_test(gamma,1,19713,21061,22743)[[1]]+stat_bin2d(binwidth = 0.003)
ggsave(file=paste(fig_path, "gamma_ORF1abvsS2.svg", sep=""), plot=l, width=10, height=8)
l
#orf1AB VS NTD
l = plot_dist_test(gamma,1,19713,19684,20142)[[1]]+stat_bin2d(binwidth = 0.003)
ggsave(file=paste(fig_path, "gamma_ORF1abvsNTD.svg", sep=""), plot=l, width=10, height=8)
l
#orf1AB VS CTD
l = plot_dist_test(gamma,1,19713,20182,20553)[[1]]+stat_bin2d(binwidth = 0.003)
ggsave(file=paste(fig_path, "gamma_ORF1abvsCTD.svg", sep=""), plot=l, width=10, height=8)
l
folder_new = 'D:/DATA/Virology/Coronaviruses/gb/new_datasets/'
delta_name = 'D-CoV_1ABSEMN_0.5_0.9ng.fasta'
delta = read.dna(paste(folder_new, 'delta/', delta_name, sep=""), format="fasta", as.character=TRUE)
delta[delta=='-'] <- NA
#orf1AB VS s1
l =plot_dist_test(delta,1,18531,18697,20007)[[1]]+stat_bin2d(binwidth = 0.003)
ggsave(file=paste(fig_path, "delta_ORF1abvsS1.svg", sep=""), plot=l, width=10, height=8)
l
#orf1AB VS s2
l = plot_dist_test(delta,1,18531,20029,21879)[[1]]+stat_bin2d(binwidth = 0.003)
ggsave(file=paste(fig_path, "delta_ORF1abvsS2.svg", sep=""), plot=l, width=10, height=8)
l
#orf1AB VS NTD
l = plot_dist_test(delta,1,18531,18697,19338)[[1]]+stat_bin2d(binwidth = 0.003)
ggsave(file=paste(fig_path, "delta_ORF1abvsNTD.svg", sep=""), plot=l, width=10, height=8)
l
#orf1AB VS CTD
l = plot_dist_test(delta,1,18531,19408,19791)[[1]]+stat_bin2d(binwidth = 0.003)
ggsave(file=paste(fig_path, "delta_ORF1abvsCTD.svg", sep=""), plot=l, width=10, height=8)
l
library("recDplot")
library(ggplot2)
library(reticulate)
library("ape")
library("seqinr")
library(sjstats)
library("spider")
library("gridExtra")
#library(hexbin)
library(grid)
library(gplots)
library(colorRamps)
pdf.options(encoding = 'CP1250')
fig_path = "C:/Users/alxva/Google Диск/Coronaviruses/paper/figures2/"
fig_path = "D:/DATA/Virology/Coronaviruses/paper/figures2/"
path_al = "D:/DATA/Virology/Coronaviruses/gb/"
#path_al = "C:/Users/alxva/Google Диск/Coronaviruses/gb/"
alpha_name = 'Alphacoronavirus_less_amb_1ABSEMN_aln_1.0_0.9ng — копия.fasta'
alpha = read.dna(paste(path_al, 'alpha/', alpha_name, sep=""), format="fasta", as.character=TRUE)
alpha[alpha=='-'] <- NA
gamma_name = 'Gammacoronavirus_less_amb_1ABSEMN_aln_0.7ng_0.5.fasta'
gamma_name = 'Gammacoronavirus_less_amb_1ABSEMN_aln_1.0_0.9ng — копия.fasta'
gamma = read.dna(paste(path_al, 'gamma/', gamma_name, sep=""), format="fasta", as.character=TRUE)
gamma[gamma=='-'] <- NA
l = plot_dist_test(gamma, 1, 10000, 10001, 20000)
d_matrix= l[[2]]
d_matrix
l[1]
d_matrix[1]
row.names(d_matrix)
rownames(d_matrix)
as.matrix(d_matrix)
d_matrix = as.matrix(d_matrix)
rownames(d_matrix)
grepl("asfakfef", "asf")
grepl("asfakfef", "asf", fixed=TRUE)
grepl( "asf","asfakfef", fixed=TRUE)
check_name = function(rownumber){
print(rownumber)
name = rownames(d_matrix)
if (grepl("_vaccine_", rowname, fixed=TRUE)){
return(rownumber)
}
}
apply(rownames(d_matrix), 1, check_name())
apply(rownames(d_matrix), 1, check_name(x))
apply(rownames(d_matrix), 1, check_name(rownumber))
check_name = function(x){
print(x)
name = rownames(d_matrix)[x]
if (grepl("_vaccine_", rowname, fixed=TRUE)){
return(x)
}
}
apply(rownames(d_matrix), 1, check_name(x))
apply(rownames(d_matrix), 1, fucntion(x) print(x))
apply(rownames(d_matrix), 1, function(x) print(x))
rownames(d_matrix)
apply(rownames(d_matrix), 0, function(x) print(x))
apply(rownames(d_matrix), 0, function(x) length(x))
sapply(rownames(d_matrix), 0, function(x) length(x))
sapply(rownames(d_matrix), function(x) length(x))
sapply(rownames(d_matrix), check_name(x))
check_name = function(x){
#print(x)
name = rownames(d_matrix)[x]
if (grepl("_vaccine_", rowname, fixed=TRUE)){
return(x)
}
}
sapply(rownames(d_matrix), check_name(x))
for (i in range(1:nrow(d_matrix))){
name = rownames(d_matrix)[i]
if (grepl("_vaccine_", rowname, fixed=TRUE)){
print(i)
}
}
for (i in range(1:nrow(d_matrix))){
name = rownames(d_matrix)[i]
if (grepl("_vaccine_", name, fixed=TRUE)){
print(i)
}
}
grepl("_vaccine_", "U817497_H52_NA_chicken_CHN_vaccine_NA 25326 bp", fixed=TRUE)
for (i in range(1:nrow(d_matrix))){
name = rownames(d_matrix)[i]
print(name)
if (grepl("_vaccine_", name, fixed=TRUE)){
print(i)
}
}
for (i in range(1:nrow(d_matrix))){
print(i)
name = rownames(d_matrix)[i]
print(name)
if (grepl("_vaccine_", name, fixed=TRUE)){
print(i)
}
}
nrow(d_matrix)
for (i in (1:nrow(d_matrix))){
print(i)
name = rownames(d_matrix)[i]
print(name)
if (grepl("_vaccine_", name, fixed=TRUE)){
print(i)
}
}
for (i in (1:nrow(d_matrix))){
name = rownames(d_matrix)[i]
print(name)
if (grepl("_vaccine_", name, fixed=TRUE)){
print(i)
}
}
for (i in (1:nrow(d_matrix))){
name = rownames(d_matrix)[i]
if (grepl("_vaccine_", name, fixed=TRUE)){
print(i)
}
}
ind=c()
ind=c()
for (i in (1:nrow(d_matrix))){
name = rownames(d_matrix)[i]
if (grepl("_vaccine_", name, fixed=TRUE)){
print(i)
ind = c(ind,i)
}
}
ind
d_matrix[ind]
d_matrix[ind,]
library("recDplot")
library(ggplot2)
library(reticulate)
library("ape")
library("seqinr")
library(sjstats)
library("spider")
library("gridExtra")
#library(hexbin)
library(grid)
library(gplots)
library(colorRamps)
gamma_name = 'Gammacoronavirus_less_amb_1ABSEMN_aln_0.7ng_0.5.fasta'
gamma_name = 'Gammacoronavirus_less_amb_1ABSEMN_aln_1.0_0.9ng — копия.fasta'
gamma = read.dna(paste(path_al, 'gamma/', gamma_name, sep=""), format="fasta", as.character=TRUE)
path_al = "D:/DATA/Virology/Coronaviruses/gb/"
#path_al = "C:/Users/alxva/Google Диск/Coronaviruses/gb/"
alpha_name = 'Alphacoronavirus_less_amb_1ABSEMN_aln_1.0_0.9ng — копия.fasta'
alpha = read.dna(paste(path_al, 'alpha/', alpha_name, sep=""), format="fasta", as.character=TRUE)
alpha[alpha=='-'] <- NA
pdf.options(encoding = 'CP1250')
fig_path = "C:/Users/alxva/Google Диск/Coronaviruses/paper/figures2/"
fig_path = "D:/DATA/Virology/Coronaviruses/paper/figures2/"
as.vector(d_matrix)
l = plot_dist_test(gamma, 1, 10000, 10001, 20000)
l = plot_dist_test(gamma, 1, 10000, 10001, 20000)
library("recDplot")
library(ggplot2)
library(reticulate)
library("ape")
library("seqinr")
library(sjstats)
library("spider")
library("gridExtra")
#library(hexbin)
library(grid)
library(gplots)
library(colorRamps)
gamma_name = 'Gammacoronavirus_less_amb_1ABSEMN_aln_0.7ng_0.5.fasta'
gamma_name = 'Gammacoronavirus_less_amb_1ABSEMN_aln_1.0_0.9ng — копия.fasta'
gamma = read.dna(paste(path_al, 'gamma/', gamma_name, sep=""), format="fasta", as.character=TRUE)
gamma[gamma=='-'] <- NA
l = plot_dist_test(gamma, 1, 10000, 10001, 20000)
l = plot_dist_test(gamma, 1, 10000, 10001, 20000)
d_matrix= as.matrix(l[[2]])
ind_vaccine=c()
ind_notvaccine=c()
for (i in (1:nrow(d_matrix))){
name = rownames(d_matrix)[i]
if (grepl("_vaccine_", name, fixed=TRUE)){
print(i)
ind_vaccine = c(ind_vaccine,i)
}
else {
ind_notvaccine = c(ind_notvaccine, i)
}
}
as.vector(d_matrix)
rownames(as.vector(d_matrix))
d_matrix[ind_vaccine]
d_matrix[ind_vaccine,]
View(d_matrix)
vac = d_matrix[ind_vaccine,]
View(vac)
vaccine_distances = as.vector(d_matrix[ind_vaccine,])
nonvaccine_distances = as.vector(d_matrix[ind_notvaccine,])
vaccine_distances
l[[3]]
d_matrix2= as.matrix(l[[3]])
vaccine_distances2 = as.vector(d_matrix2[ind_vaccine,])
nonvaccine_distances2 = as.vector(d_matrix2[ind_notvaccine,])
plot(vaccine_distances1,vaccine_distances2)
vaccine_distances1 = as.vector(d_matrix[ind_vaccine,])
nonvaccine_distances1 = as.vector(d_matrix[ind_notvaccine,])
plot(vaccine_distances1,vaccine_distances2)
plot(nonvaccine_distances1,nonvaccine_distances2)
plot(vaccine_distances1,vaccine_distances2, color = 'r')
length(vaccine_distances2)
v = repeat(c('vaccine'), times = length(vaccine_distances2))
v = repeat(c('vaccine') times = length(vaccine_distances2))
v = repeat(c('vaccine'), times = length(vaccine_distances2))
v = rep(c('vaccine'), times = length(vaccine_distances2))
df = data.frame(vaccine_distances1,vaccine_distances2,v)
df
df = rbind(data.frame(vaccine_distances1,vaccine_distances2,v),data.frame(nonvaccine_distances1,nonvaccine_distances2,nv))
nv = rep(c('non_vaccine'), times = length(nonvaccine_distances2))
df = rbind(data.frame(vaccine_distances1,vaccine_distances2,v),data.frame(nonvaccine_distances1,nonvaccine_distances2,nv))
data.frame(vaccine_distances1,vaccine_distances2,v, colnames=c(d1,d2,q))
data.frame(vaccine_distances1,vaccine_distances2,v, colnames=c("d1","d2","q"))
df = data.frame(vaccine_distances1,vaccine_distances2,v)
colnames(df)
colnames(df) = c('d1','d2', 'q')
df
df1 = data.frame(vaccine_distances1,vaccine_distances2,v)
df2 = data.frame(nonvaccine_distances1,nonvaccine_distances2,nv)
colnames(df1) = c('d1','d2', 'q')
colnames(df2) = c('d1','d2', 'q')
df= rbind(df1,df2)
ggplot(data.frame(df),aes(df$d1,df$d2)) + geom_point(color=df$q) +
theme(legend.justification=c(1,0), legend.position=c(1,0))+
xlab("dist1")+ylab("dist2")
ggplot(data.frame(df),aes(df$d1,df$d2), label=df$q) + geom_point() +
theme(legend.justification=c(1,0), legend.position=c(1,0))+
xlab("dist1")+ylab("dist2")
ggplot(data.frame(df),aes(df$d1,df$d2), label=df$q) + geom_point(aes(color=q)) +
theme(legend.justification=c(1,0), legend.position=c(1,0))+
xlab("dist1")+ylab("dist2")
df= rbind(df2,df1)
ggplot(data.frame(df),aes(df$d1,df$d2), label=df$q) + geom_point(aes(color=q)) +
theme(legend.justification=c(1,0), legend.position=c(1,0))+
xlab("dist1")+ylab("dist2")
